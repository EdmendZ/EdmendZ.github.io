<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>OpenGL | TryhardZhang Blog</title><meta name="keywords" content="Graphics"><meta name="author" content="Edmend Zhang"><meta name="copyright" content="Edmend Zhang"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="OpenGL"><meta name="application-name" content="OpenGL"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="OpenGL"><meta property="og:url" content="http://example.com/2024/07/30/graphics/opengl/Opengl/index.html"><meta property="og:site_name" content="TryhardZhang Blog"><meta property="og:description" content="OpenGL - Graphics"><meta property="og:locale" content="en"><meta property="og:image" content="https://tryhardzhangblog.oss-us-west-1.aliyuncs.com/cover_top_image/Photo%20by%20Adam%20Jaime%20%28iciBcD8NOeA%29.jpg?_r_=1dc7bada-bd3d-f366-f044-1e3cac7bc9c9"><meta property="article:author" content="Edmend Zhang"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://tryhardzhangblog.oss-us-west-1.aliyuncs.com/cover_top_image/Photo%20by%20Adam%20Jaime%20%28iciBcD8NOeA%29.jpg?_r_=1dc7bada-bd3d-f366-f044-1e3cac7bc9c9"><meta name="description" content="OpenGL - Graphics"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="http://example.com/2024/07/30/graphics/opengl/Opengl/"><link rel="preconnect" href="//cdn.cbd.int"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/swiper/swiper.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: {"enable":true,"title":"与数百名博主无限进步","addFriendPlaceholder":"昵称（请勿包含博客等字样）：\n网站地址（要求博客地址，请勿提交个人主页）：\n头像图片url（请提供尽可能清晰的图片，我会上传到我自己的图床）：\n描述：\n站点截图（可选）：\n"},
  peoplecanvas: undefined,
  postHeadAiDescription: {"enable":true,"gptName":"AnZhiYu","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w 不要走！再看看嘛！","backTitle":"♪(^∇^*)欢迎肥来！"},
  LA51: undefined,
  greetingBox: undefined,
  twikooEnvId: 'https://tryhardzhang.netlify.app/.netlify/functions/twikoo',
  commentBarrageConfig:undefined,
  root: '/',
  preloader: {"source":3},
  friends_vue_info: {"apiurl":null},
  navMusic: true,
  mainTone: undefined,
  authorStatus: {"skills":["🤖️ 游戏数码爱好者","🔍 分享与热心帮助","🏠 桌游剧本杀玩家","🔨 设计开发一条龙","🤝 游戏设计图形学","🏃 脚踏实地行动派","🧱 团队小组发动机","💢 壮汉人狠话不多"]},
  algolia: {"appId":"ZFUDQRDP4H","apiKey":"ba6322d83bf3628e149410dca0d696f6","indexName":"hexo","hits":{"per_page":6},"languages":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}.","hits_stats":"${hits} results found in ${time} ms"}},
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: 'days',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"Author: Edmend Zhang","link":"Link: ","source":"Source: TryhardZhang Blog","info":"Copyright is owned by the author. For commercial reprints, please contact the author for authorization. For non-commercial reprints, please indicate the source.","copySuccess":"Copy success, copy and reprint please mark the address of this article"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"Traditional Chinese Activated Manually","cht_to_chs":"Simplified Chinese Activated Manually","day_to_night":"Dark Mode Activated Manually","night_to_day":"Light Mode Activated Manually","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: 'TryhardZhang Blog',
  title: 'OpenGL',
  postAI: '',
  pageFillDescription: 'OpenGL （1）, GLFW, Glad, 双缓存, Shader 如何从CPU获取数据, Shader, Vertex Buffer Object (VBO), Vertex Array Object (VAO), 程序中关系, 流程, VAO 模式绘制, OPENGL 部分配置问题, 多个VBO的情况, Shader与C++传输, 顶点索引, EBO Element Buffer Object, Texture, 步骤, STB_IMAGE 读取图片, Texture Wrapping, Texture Filter, 摄像机, 摄像机矩阵, 初始呈像, Lookat角度 并没有开启深度检测, 加入深度检测后, 摄像机的移动旋转, Rotate move运算规则, LookAt作用, camera.cpp, 摄像机转动, pitch yaw and roll, 光照, Phong Shader 模型, 环境光 Shader, 漫反射 Shader, 漫反射 法线矩阵证明, 补充, transpose(inverse(_modelMatrix)), 镜面反射, 材质系统与窗口分离本身不负责创建窗口管理窗口事件或者处理输入设备这些任务通常由其他库或操作系统提供的窗口系统接口来处理由于视口右手坐标系是一个用于创建窗口处理输入以及管理上下文的开源库它简化了程序的开发提供了跨平台的接口使得开发者可以专注于渲染和图形处理而不必担心底层平台特定的窗口系统和输入处理支持和等多个操作系统是实现函数指针的映射是状态机保存自己渲染的状态和管线的状态初始化库终止库释放资源创建一个窗口并返回其句柄设置指定窗口的上下文为当前上下文检查窗口是否应关闭交换窗口的前后缓冲处理所有待处理的事件加载函数指针函数的地址需要在运行时通过特定的方式获取这与直接调用标准库中的函数不同帮助开发者在运行时加载这些函数指针以便应用程序能够调用最新的功能管理扩展是一个不断发展的标准不同的显卡和驱动程序可能支持不同的扩展允许你指定需要的扩展并生成相应的加载代码以便在应用程序中使用这些扩展跨平台支持支持多种操作系统如和多种版本使得开发者可以编写跨平台的代码可以定义应该在哪个视口进行渲染双缓存如何从获取数据锚点信息告诉信息布局分别是什么是一种用于存储顶点数据的缓冲区对象它允许将顶点数据例如顶点坐标法线纹理坐标等存储在内存中以便快速访问和渲染使用可以显著提高渲染性能因为数据传输的瓶颈被减少了获取的绑定给分配显存空间传输数据告诉数据解析方式激活锚点是一种用于存储顶点属性配置的对象它保存了顶点属性指针的状态以及与之关联的的作用是简化顶点属性配置的过程通过绑定可以快速恢复先前配置好的顶点属性状态程序中关系管理和维护与绘制相关的及其顶点属性状态当我们创建和配置时会指定使用哪些以及如何解析它们的数据这样当我们使用进行绘制时所有与相关的状态都会自动应用流程模型数据建立发送到把顶点传输到里进行空间变换操作并行处理到对各个顶点之间进行插值着色模式绘制渲染绘制图形类型第个起始个关掉程序构建模型完成获取绑定获取获取的可以获取多个绑定哪种的哪一个显存分配类型大小位置如何使用数据模型数据不会改变做锚定点锚定点个数据数据类型是否归一化跨步步长数据读取开始位置激活锚定点取消绑定编写扩展允许扩展允许提取的编译链接编译创建传代码检查编译状态编译创建传代码检查编译状态链接加入编译好的去掉中间状态文件只保留最后编译好的当有任何输入时比如键盘或鼠标事件状态初始化版本选择配置项配置结果窗口定义窗口宽高名字当前上下文窗口绑定为当前窗口初始化函数指针窗口大小变化会调用函数设置清除颜色清除画布颜色是下一帧要显示的所有像素信息双缓存操作系统获取输入和其他事件并处理用于部分配置问题选择核心配置文件核心配置文件排除了一些较旧的不再推荐使用的功能它仅支持现代的功能和特性使用核心配置文件时必须使用现代的函数和特性例如顶点缓冲对象顶点数组对象和着色器等传统的固定管线功能如直接使用和的绘图方法在核心配置文件中不可用绑定是强制的选择兼容配置文件兼容配置文件包含了所有功能包括新的和旧的特性这意味着你可以在一个应用程序中使用传统的固定管线功能和现代的功能兼容配置文件对于需要支持老旧硬件或依赖于传统功能的应用程序很有用状态初始化版本选择配置项配置结果配置项配置结果多个的情况和是两个完全不同的缓存为什么会覆盖掉的结果导不显示因为锚定点的问题渲染绘制图形类型第个起始个关掉程序构建模型完成获取绑定获取获取的可以获取多个绑定哪种的哪一个显存分配类型大小位置如何使用数据模型数据不会改变做锚定点锚定点个数据数据类型是否归一化跨步步长数据读取开始位置激活锚定点取消绑定获取绑定获取获取的可以获取多个绑定哪种的哪一个显存分配类型大小位置如何使用数据模型数据不会改变做锚定点锚定点个数据数据类型是否归一化跨步步长数据读取开始位置激活锚定点取消绑定多个记录了锚点信息所以不需要重新设置锚点渲染绘制图形类型第个起始个关掉程序图形类型第个起始个关掉程序构建模型完成获取绑定获取获取的可以获取多个绑定哪种的哪一个显存分配类型大小位置如何使用数据模型数据不会改变做锚定点锚定点个数据数据类型是否归一化跨步步长数据读取开始位置激活锚定点取消绑定结束绑定获取绑定获取获取的可以获取多个绑定哪种的哪一个显存分配类型大小位置如何使用数据模型数据不会改变做锚定点锚定点个数据数据类型是否归一化跨步步长数据读取开始位置激活锚定点取消绑定结束绑定与传输变量有限定义了如果未使用会被系统删除渲染绘制提前启用从已经构建好滴程序获取变量传输个图形类型第个起始个关掉程序顶点索引剔除重复顶点传输顶点索引步骤定义坐标获取插值结果与实际坐标相乘获得实际插值读取图片从文件中加载图像并返回图像数据的指针同时提供图像的宽度高度和通道数从内存中加载图像数据适用于已经在内存中的图像从文件指针加载图像类似于但使用作为输入使用自定义回调接口加载图像适用于自定义的输入输出系统释放由系列函数分配的图像数据内存获取图像的基本信息宽度高度通道数而不加载图像数据设置在加载图像时是否垂直翻转图像的标志返回最后一次失败的原因描述检查图像文件是否为高动态范围图像加载图像并以浮点数据的形式返回图像数据坐标超出的范围需要重复采样通过和获取坐标位小数需要取整找最近的点找四个求平均值图片小使用因为像素差异变大图片大使用更加平滑摄像机摄像机矩阵获取当前变量的或锚定符向的传入数据列优先正交投影初始呈像角度并没有开启深度检测设置清除颜色清除画布颜色是下一帧要显示的所有像素信息加入深度检测后摄像机的移动旋转渲染绘制设置清除颜色清除画布颜色是下一帧要显示的所有像素信息摄像机矩阵画十个立方体平移图形类型第个起始个关掉程序运算规则矩阵在右边设置清除颜色清除画布颜色是下一帧要显示的所有像素信息摄像机矩阵画十个立方体平移图形类型第个起始个关掉程序作用由减数到被减数的向量需要是一个单位向量每次循环都会被调用检测是否使用按键当有任何输入时比如键盘或鼠标事件摄像机转动的正方向走向的正方向为的正值的正方向走向的负方向是负值需要检测是不是记录开始的坐标先记录再对比再剪除的窗体位置再左上角向上坐标减小向下坐标增大所以会相反渲染绘制设置清除颜色清除画布颜色是下一帧要显示的所有像素信息摄像机矩阵画十个立方体平移图形类型第个起始个关掉程序构建模型完成获取是管理容器绑定向系统获取一个获取获取的可以获取多个绑定哪种的哪一个显存分配类型大小位置如何使用数据模型数据不会改变做锚定点锚定点个数据数据类型是否归一化跨步步长数据读取开始位置锚定点传递颜色信息激活锚定点激活锚定点取消绑定结束绑定创建纹理获取传入数据编写当有任何输入时比如键盘或鼠标事件状态初始化版本选择配置项配置结果配置项配置结果窗口定义窗口宽高名字当前上下文窗口绑定为当前窗口初始化函数指针窗口大小变化会调用函数鼠标控制鼠标不显示双缓存操作系统获取输入和其他事件并处理用于光照模型环境光环境光强度系数漫反射平移部分不会影响法线向量的计算为可以消除平移的影响将顶点的坐标转换到视图空间之中是世界坐标漫反射法线矩阵证明在这里可以转化为转置后的矩阵乘法补充与上次的结果产生了叠加可以使用清空对于法线向量的正确变换仅仅使用模型矩阵的逆矩阵是不够的需要使用逆矩阵的转置矩阵来确保法线的正确性为什么使用逆矩阵对于位置向量我们使用模型矩阵来变换它们然而对于法线向量特别是在非均匀缩放的情况下如果直接使用模型矩阵来变换法线方向可能会失真因此使用逆矩阵来反向缩放确保法线向量的方向不受不均匀缩放的影响为什么转置转置操作将行向量转换为列向量或反之这是确保法线方向保持正确的必要步骤因为它对法线向量施加了正确的几何变换定义为的变量会被输出到下一个步骤自动处理经过偏移之后的世界坐标环境光强度环境光漫反射镜面反射材质系统材质和光都有自己的属性',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-07-31 11:26:16',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.1.1"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://tryhardzhangblog.oss-us-west-1.aliyuncs.com/blog_image/20240410162417.png"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><a id="site-name" href="/" accesskey="h"><div class="title">TryhardZhang Blog</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 想法</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/?id=9570676565&amp;server=netease"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册集</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/air-conditioner/"><i class="anzhiyufont anzhiyu-icon-fan faa-tada" style="font-size: 0.9em;"></i><span> 小空调</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 闲言碎语</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随便逛逛</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" title="搜索🔍" accesskey="s"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span> Search</span></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png" target="_blank"><img class="post-qr-code-img" alt="微信" src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png" target="_blank"><img class="post-qr-code-img" alt="支付宝" src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> Newest Comments</span></div><div class="aside-list"><span>loading...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/Docker/" style="font-size: 1.05rem;">Docker<sup>2</sup></a><a href="/tags/Graphics/" style="font-size: 1.05rem;">Graphics<sup>13</sup></a><a href="/tags/Graphics-Games101/" style="font-size: 1.05rem;">Graphics - Games101<sup>1</sup></a><a href="/tags/Home-Assistant-%E9%9B%86%E6%88%90-Frigate-%E5%8A%9F%E8%83%BD%E5%B1%95%E7%A4%BA/" style="font-size: 1.05rem;">Home Assistant 集成 Frigate 功能展示<sup>1</sup></a><a href="/tags/HomeAssistant/" style="font-size: 1.05rem;">HomeAssistant<sup>1</sup></a><a href="/tags/RTP/" style="font-size: 1.05rem;">RTP<sup>1</sup></a><a href="/tags/RTSP/" style="font-size: 1.05rem;">RTSP<sup>3</sup></a><a href="/tags/concepts/" style="font-size: 1.05rem;">concepts<sup>2</sup></a><a href="/tags/csen-272/" style="font-size: 1.05rem;">csen 272<sup>2</sup></a><a href="/tags/live555/" style="font-size: 1.05rem;">live555<sup>1</sup></a><a href="/tags/nlp/" style="font-size: 1.05rem;">nlp<sup>2</sup></a><a href="/tags/search/" style="font-size: 1.05rem;">search<sup>2</sup></a><a href="/tags/%E5%8D%9A%E5%AE%A2/" style="font-size: 1.05rem;">博客<sup>1</sup></a><a href="/tags/%E8%99%9A%E6%8B%9F%E6%9C%BA/" style="font-size: 1.05rem;">虚拟机<sup>1</sup></a><a href="/tags/%E8%A7%86%E9%A2%91%E6%92%AD%E6%94%BE%E5%99%A8/" style="font-size: 1.05rem;">视频播放器<sup>1</sup></a><a href="/tags/%E8%A7%86%E9%A2%91%E6%B5%81%E4%BC%A0%E8%BE%93/" style="font-size: 1.05rem;">视频流传输<sup>1</sup></a><a href="/tags/%E8%AF%BE%E7%A8%8B/" style="font-size: 1.05rem;">课程<sup>1</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>Archives</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/07/"><span class="card-archive-list-date">July 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">25</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/04/"><span class="card-archive-list-date">April 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">7</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/Graphics/" itemprop="url">Graphics</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/Graphics/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>Graphics</span></a></span></div></div><h1 class="post-title" itemprop="name headline">OpenGL</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2024-07-30T00:00:00.000Z" title="Created 2024-07-30 00:00:00">2024-07-30</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2024-07-31T11:26:16.554Z" title="Updated 2024-07-31 11:26:16">2024-07-31</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span id="" data-flag-title="OpenGL"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label" title="阅读量">Post View:</span><span id="twikoo_visitors" title="访问量"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为Chengdu"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>Chengdu</span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="https://tryhardzhangblog.oss-us-west-1.aliyuncs.com/cover_top_image/Photo%20by%20Adam%20Jaime%20%28iciBcD8NOeA%29.jpg?_r_=1dc7bada-bd3d-f366-f044-1e3cac7bc9c9"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="http://example.com/2024/07/30/graphics/opengl/Opengl/"><header><a class="post-meta-categories" href="/categories/Graphics/" itemprop="url">Graphics</a><a href="/tags/Graphics/" tabindex="-1" itemprop="url">Graphics</a><h1 id="CrawlerTitle" itemprop="name headline">OpenGL</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">Edmend Zhang</span><time itemprop="dateCreated datePublished" datetime="2024-07-30T00:00:00.000Z" title="Created 2024-07-30 00:00:00">2024-07-30</time><time itemprop="dateCreated datePublished" datetime="2024-07-31T11:26:16.554Z" title="Updated 2024-07-31 11:26:16">2024-07-31</time></header><h1 id="OpenGL-（1）"><a href="#OpenGL-（1）" class="headerlink" title="OpenGL （1）"></a>OpenGL （1）</h1><ul>
<li><strong>与窗口分离</strong></li>
</ul>
<p>OpenGL本身不负责创建窗口、管理窗口事件或者处理输入设备。这些任务通常由其他库或操作系统提供的窗口系统接口来处理。</p>
<p>由于viewport视口</p>
<ul>
<li>右手坐标系</li>
</ul>
<h2 id="GLFW"><a href="#GLFW" class="headerlink" title="GLFW"></a>GLFW</h2><p>GLFW（Graphics Library Framework）是一个用于创建窗口、处理输入以及管理OpenGL上下文的开源库。它简化了OpenGL程序的开发，提供了跨平台的接口，使得开发者可以专注于渲染和图形处理，而不必担心底层平台特定的窗口系统和输入处理。GLFW支持Windows、macOS和Linux等多个操作系统。</p>
<p><strong>Glad 是实现函数指针的映射</strong></p>
<p><strong>opengl是状态机 保存自己渲染的状态和管线的状态</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">glfwInit</span>()：初始化GLFW库。</span><br><span class="line"><span class="built_in">glfwTerminate</span>()：终止GLFW库，释放资源。</span><br><span class="line"><span class="built_in">glfwCreateWindow</span>(width, height, title, monitor, share)：创建一个窗口并返回其句柄。</span><br><span class="line"><span class="built_in">glfwMakeContextCurrent</span>(window)：设置指定窗口的OpenGL上下文为当前上下文。</span><br><span class="line"><span class="built_in">glfwWindowShouldClose</span>(window)：检查窗口是否应关闭。</span><br><span class="line"><span class="built_in">glfwSwapBuffers</span>(window)：交换窗口的前后缓冲。</span><br><span class="line"><span class="built_in">glfwPollEvents</span>()：处理所有待处理的事件。</span><br></pre></td></tr></table></figure>

<h2 id="Glad"><a href="#Glad" class="headerlink" title="Glad"></a>Glad</h2><ol>
<li><strong>加载OpenGL函数指针</strong>： OpenGL函数的地址需要在运行时通过特定的方式获取，这与直接调用标准库中的函数不同。Glad帮助开发者在运行时加载这些函数指针，以便应用程序能够调用最新的OpenGL功能。</li>
<li><strong>管理OpenGL扩展</strong>： OpenGL是一个不断发展的标准，不同的显卡和驱动程序可能支持不同的OpenGL扩展。Glad允许你指定需要的扩展，并生成相应的加载代码，以便在应用程序中使用这些扩展。</li>
<li><strong>跨平台支持</strong>： Glad支持多种操作系统（如Windows、Linux、macOS）和多种OpenGL版本，使得开发者可以编写跨平台的OpenGL代码。</li>
</ol>
<p><strong>Viewport可以定义应该在哪个视口进行渲染</strong></p>
<h3 id="双缓存"><a href="#双缓存" class="headerlink" title="双缓存"></a>双缓存</h3><p>glfwSwapBuffers(window); </p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://tryhardzhangblog.oss-us-west-1.aliyuncs.com/blog_image/image-20240725170542865.png" alt="image-20240725170542865"></p>
<h2 id="Shader-如何从CPU获取数据"><a href="#Shader-如何从CPU获取数据" class="headerlink" title="Shader 如何从CPU获取数据"></a>Shader 如何从CPU获取数据</h2><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://tryhardzhangblog.oss-us-west-1.aliyuncs.com/blog_image/image-20240725173954896.png" alt="image-20240725173954896"></p>
<ul>
<li>Layout 锚点信息 告诉信息布局 分别是什么</li>
</ul>
<h2 id="Shader"><a href="#Shader" class="headerlink" title="Shader"></a>Shader</h2><h3 id="Vertex-Buffer-Object-VBO"><a href="#Vertex-Buffer-Object-VBO" class="headerlink" title="Vertex Buffer Object (VBO)"></a>Vertex Buffer Object (VBO)</h3><p>VBO 是一种用于存储顶点数据的缓冲区对象。它允许将顶点数据（例如顶点坐标、法线、纹理坐标等）存储在 GPU 内存中，以便快速访问和渲染。使用 VBO 可以显著提高渲染性能，因为数据传输的瓶颈被减少了。</p>
<ol>
<li>获取VBO的index</li>
<li>绑定VBO</li>
<li>给VBO分配显存空间 传输数据</li>
<li>告诉shader数据解析方式</li>
<li>激活锚点</li>
</ol>
<h3 id="Vertex-Array-Object-VAO"><a href="#Vertex-Array-Object-VAO" class="headerlink" title="Vertex Array Object (VAO)"></a>Vertex Array Object (VAO)</h3><p>VAO 是一种用于存储顶点属性配置的对象。它保存了顶点属性指针的状态以及与之关联的 VBO。VAO 的作用是简化顶点属性配置的过程，通过绑定 VAO，可以快速恢复先前配置好的顶点属性状态。</p>
<h3 id="程序中关系"><a href="#程序中关系" class="headerlink" title="程序中关系"></a>程序中关系</h3><p>VAO 管理和维护与绘制相关的 VBO 及其顶点属性状态。当我们创建和配置 VAO 时，会指定使用哪些 VBO 以及如何解析它们的数据。这样，当我们使用 VAO 进行绘制时，所有与 VBO 相关的状态都会自动应用。</p>
<h3 id="流程"><a href="#流程" class="headerlink" title="流程"></a>流程</h3><ul>
<li><strong>模型数据建立</strong></li>
<li><strong>发送到GPU</strong></li>
<li><strong>GPU把顶点传输到vertexShader里</strong></li>
<li><strong>VertexShader 进行空间变换操作，并行处理</strong></li>
<li><strong>到FragmentShader对各个顶点之间进行插值着色</strong></li>
</ul>
<h2 id="VAO-模式绘制"><a href="#VAO-模式绘制" class="headerlink" title="VAO 模式绘制"></a>VAO 模式绘制</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;glad/glad.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;GLFW/glfw3.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sstream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> VBO = <span class="number">0</span>;</span><br><span class="line"><span class="type">unsigned</span> VAO = <span class="number">0</span>;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> shaderProgram = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 渲染绘制</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rend</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">glBindVertexArray</span>(VAO);</span><br><span class="line">	<span class="built_in">glUseProgram</span>(shaderProgram);</span><br><span class="line">	<span class="built_in">glDrawArrays</span>(GL_TRIANGLES, <span class="number">0</span>, <span class="number">3</span>); <span class="comment">// 图形类型 第0个起始 3个</span></span><br><span class="line">	<span class="built_in">glUseProgram</span>(<span class="number">0</span>); <span class="comment">// 关掉程序</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 构建模型 完成VBO VAO</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">initModel</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">float</span> vertices[] =</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="number">-0.5f</span>, <span class="number">-0.5f</span>, <span class="number">0.0f</span>,</span><br><span class="line">		<span class="number">0.5f</span>, <span class="number">-0.5f</span>, <span class="number">0.0f</span>,</span><br><span class="line">		<span class="number">0.0f</span>, <span class="number">0.5f</span>, <span class="number">0.0f</span></span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">glGenVertexArrays</span>(<span class="number">1</span>, &amp;VAO); <span class="comment">// 获取VAO</span></span><br><span class="line">	<span class="built_in">glBindVertexArray</span>(VAO); <span class="comment">// 绑定VAO</span></span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 1. 获取VBO index</span></span><br><span class="line">	<span class="built_in">glGenBuffers</span>(<span class="number">1</span>, &amp;VBO); <span class="comment">// 获取VBO的index 可以获取多个VBO index</span></span><br><span class="line">	<span class="built_in">glBindBuffer</span>(GL_ARRAY_BUFFER, VBO); <span class="comment">// 绑定哪种buffer的哪一个</span></span><br><span class="line">	<span class="built_in">glBufferData</span>(GL_ARRAY_BUFFER, <span class="built_in">sizeof</span>(vertices), vertices, GL_STATIC_DRAW); <span class="comment">// 显存分配,类型、大小、位置、如何使用数据（GL_STATIC_DRAW 模型数据不会改变)</span></span><br><span class="line">	<span class="built_in">glVertexAttribPointer</span>(<span class="number">0</span>, <span class="number">3</span>, GL_FLOAT, GL_FALSE, <span class="number">3</span> * <span class="built_in">sizeof</span>(<span class="type">float</span>), (<span class="type">void</span>*)<span class="number">0</span>); <span class="comment">// 做锚定点 layout 锚定点0，3个数据，数据类型，是否归一化，跨步步长，数据读取开始位置</span></span><br><span class="line">	<span class="built_in">glEnableVertexAttribArray</span>(<span class="number">0</span>); <span class="comment">// 激活锚定点</span></span><br><span class="line">	<span class="built_in">glBindBuffer</span>(GL_ARRAY_BUFFER, <span class="number">0</span>); <span class="comment">// 取消绑定</span></span><br><span class="line">	<span class="built_in">glBindVertexArray</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Shader编写</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">initShader</span><span class="params">(<span class="type">const</span> <span class="type">char</span>* _vertexPath, <span class="type">const</span> <span class="type">char</span>* _fragPath)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	std::string _vertexCode(<span class="string">&quot;&quot;</span>);</span><br><span class="line">	std::string _fragCode(<span class="string">&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line">	std::ifstream _vShaderFile;</span><br><span class="line">	std::ifstream _fShaderFile;</span><br><span class="line"></span><br><span class="line">	_vShaderFile.<span class="built_in">exceptions</span>(std::ifstream::failbit | std::ifstream::badbit); <span class="comment">// 扩展 允许trycatch</span></span><br><span class="line">	_fShaderFile.<span class="built_in">exceptions</span>(std::ifstream::failbit | std::ifstream::badbit); <span class="comment">// 扩展 允许trycatch</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">try</span></span><br><span class="line">	&#123;</span><br><span class="line">		_vShaderFile.<span class="built_in">open</span>(_vertexPath);</span><br><span class="line">		_fShaderFile.<span class="built_in">open</span>(_fragPath);</span><br><span class="line"></span><br><span class="line">		std::stringstream _vShaderStream, _fShaderStream;</span><br><span class="line">		_vShaderStream &lt;&lt; _vShaderFile.<span class="built_in">rdbuf</span>();</span><br><span class="line">		_fShaderStream &lt;&lt; _fShaderFile.<span class="built_in">rdbuf</span>();</span><br><span class="line"></span><br><span class="line">		_vertexCode = _vShaderStream.<span class="built_in">str</span>();</span><br><span class="line">		_fragCode = _fShaderStream.<span class="built_in">str</span>();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">catch</span> (std::ifstream::failure e)</span><br><span class="line">	&#123;</span><br><span class="line">		std::string errStr = <span class="string">&quot;read shader fail&quot;</span>;</span><br><span class="line">		std::cout &lt;&lt; errStr &lt;&lt; std::endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="type">const</span> <span class="type">char</span>* _vShaderStr = _vertexCode.<span class="built_in">c_str</span>(); <span class="comment">// 提取</span></span><br><span class="line">	<span class="type">const</span> <span class="type">char</span>* _fShaderStr = _fragCode.<span class="built_in">c_str</span>();</span><br><span class="line"></span><br><span class="line">	<span class="comment">// shader的编译链接</span></span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> _vertexID = <span class="number">0</span>, _fragID = <span class="number">0</span>;</span><br><span class="line">	<span class="type">char</span>		 _infoLog[<span class="number">512</span>];</span><br><span class="line">	<span class="type">int</span>			 _successFlag = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// vertexShader 编译</span></span><br><span class="line">	_vertexID = <span class="built_in">glCreateShader</span>(GL_VERTEX_SHADER); <span class="comment">// 创建shaderID</span></span><br><span class="line">	<span class="built_in">glShaderSource</span>(_vertexID, <span class="number">1</span>, &amp;_vShaderStr, <span class="literal">NULL</span>); <span class="comment">// 传代码</span></span><br><span class="line">	<span class="built_in">glCompileShader</span>(_vertexID);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">glGetShaderiv</span>(_vertexID, GL_COMPILE_STATUS, &amp;_successFlag); <span class="comment">// 检查编译状态</span></span><br><span class="line">	<span class="keyword">if</span> (!_successFlag)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">glGetShaderInfoLog</span>(_vertexID, <span class="number">512</span>, <span class="literal">NULL</span>, _infoLog);</span><br><span class="line">		<span class="function">std::string <span class="title">errStr</span><span class="params">(_infoLog)</span></span>;</span><br><span class="line">		std::cout &lt;&lt; errStr &lt;&lt; std::endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// fragmentShader 编译</span></span><br><span class="line">	_fragID = <span class="built_in">glCreateShader</span>(GL_FRAGMENT_SHADER); <span class="comment">// 创建shaderID</span></span><br><span class="line">	<span class="built_in">glShaderSource</span>(_fragID, <span class="number">1</span>, &amp;_fShaderStr, <span class="literal">NULL</span>); <span class="comment">// 传代码</span></span><br><span class="line">	<span class="built_in">glCompileShader</span>(_fragID);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">glGetShaderiv</span>(_fragID, GL_COMPILE_STATUS, &amp;_successFlag); <span class="comment">// 检查编译状态</span></span><br><span class="line">	<span class="keyword">if</span> (!_successFlag)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">glGetShaderInfoLog</span>(_fragID, <span class="number">512</span>, <span class="literal">NULL</span>, _infoLog);</span><br><span class="line">		<span class="function">std::string <span class="title">errStr</span><span class="params">(_infoLog)</span></span>;</span><br><span class="line">		std::cout &lt;&lt; errStr &lt;&lt; std::endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 链接 加入编译好的shader</span></span><br><span class="line">	shaderProgram = <span class="built_in">glCreateProgram</span>();</span><br><span class="line">	<span class="built_in">glAttachShader</span>(shaderProgram, _vertexID);</span><br><span class="line">	<span class="built_in">glAttachShader</span>(shaderProgram, _fragID);</span><br><span class="line">	<span class="built_in">glLinkProgram</span>(shaderProgram);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">glGetProgramiv</span>(shaderProgram, GL_LINK_STATUS, &amp;_successFlag);</span><br><span class="line">	<span class="keyword">if</span> (!_successFlag)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">glGetProgramInfoLog</span>(shaderProgram, <span class="number">512</span>, <span class="literal">NULL</span>, _infoLog);</span><br><span class="line">		<span class="function">std::string <span class="title">errStr</span><span class="params">(_infoLog)</span></span>;</span><br><span class="line">		std::cout &lt;&lt; errStr &lt;&lt; std::endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// 去掉中间状态文件 只保留最后编译好的</span></span><br><span class="line">	<span class="built_in">glDeleteShader</span>(_vertexID);</span><br><span class="line">	<span class="built_in">glDeleteShader</span>(_fragID);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">framebuffer_size_callback</span><span class="params">(GLFWwindow* window, <span class="type">int</span> width, <span class="type">int</span> height)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">glViewport</span>(<span class="number">0</span>, <span class="number">0</span>, width, height);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 当有任何输入时 比如键盘或鼠标事件</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">processInput</span><span class="params">(GLFWwindow* window)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (<span class="built_in">glfwGetKey</span>(window, GLFW_KEY_ESCAPE) == GLFW_PRESS)</span><br><span class="line">		<span class="built_in">glfwSetWindowShouldClose</span>(window, <span class="literal">true</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">glfwInit</span>(); <span class="comment">// opengl 状态初始化</span></span><br><span class="line">	<span class="comment">// 版本选择</span></span><br><span class="line">	<span class="built_in">glfwWindowHint</span>(GLFW_CONTEXT_VERSION_MAJOR, <span class="number">3</span>);</span><br><span class="line">	<span class="built_in">glfwWindowHint</span>(GLFW_CONTEXT_VERSION_MINOR, <span class="number">3</span>);</span><br><span class="line">	<span class="built_in">glfwWindowHint</span>(GLFW_OPENGL_PROFILE, GLFW_OPENGL_CORE_PROFILE); <span class="comment">//（配置项，配置结果）</span></span><br><span class="line"></span><br><span class="line">	GLFWwindow* window = <span class="built_in">glfwCreateWindow</span>(<span class="number">800</span>, <span class="number">600</span>, <span class="string">&quot;OpenGL Core&quot;</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>);  <span class="comment">// 窗口定义	// 窗口宽高 名字</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (window == <span class="literal">NULL</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		std::cout &lt;&lt; <span class="string">&quot;Failed to create GLFW window&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">		<span class="built_in">glfwTerminate</span>();</span><br><span class="line">		<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">glfwMakeContextCurrent</span>(window); <span class="comment">// 当前上下文窗口绑定为当前窗口</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (!<span class="built_in">gladLoadGLLoader</span>((GLADloadproc)glfwGetProcAddress)) <span class="comment">// 初始化函数指针</span></span><br><span class="line">	&#123;</span><br><span class="line">		std::cout &lt;&lt; <span class="string">&quot;Fialed to initialize GLAD&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">glViewport</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">800</span>, <span class="number">600</span>);</span><br><span class="line">	<span class="built_in">glfwSetFramebufferSizeCallback</span>(window, framebuffer_size_callback); <span class="comment">// 窗口大小变化会调用函数</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">initModel</span>();</span><br><span class="line">	<span class="built_in">initShader</span>(<span class="string">&quot;vertexShader.glsl&quot;</span>, <span class="string">&quot;fragmentShader.glsl&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span> (!<span class="built_in">glfwWindowShouldClose</span>(window))</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">processInput</span>(window);</span><br><span class="line"></span><br><span class="line">		<span class="built_in">glClearColor</span>(<span class="number">0.2f</span>, <span class="number">0.3f</span>, <span class="number">0.3f</span>, <span class="number">1.0f</span>); <span class="comment">// 设置清除颜色</span></span><br><span class="line">		<span class="built_in">glClear</span>(GL_COLOR_BUFFER_BIT); <span class="comment">// 清除画布颜色， GL_COLOR_BUFFER_BIT是下一帧要显示的所有像素信息</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">// render</span></span><br><span class="line">		<span class="built_in">rend</span>();</span><br><span class="line"></span><br><span class="line">		<span class="built_in">glfwSwapBuffers</span>(window); <span class="comment">// 双缓存</span></span><br><span class="line">		<span class="built_in">glfwPollEvents</span>(); <span class="comment">// 操作系统获取输入和其他事件并处理 用于processInput</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">glfwTerminate</span>();</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="OPENGL-部分配置问题"><a href="#OPENGL-部分配置问题" class="headerlink" title="OPENGL 部分配置问题"></a>OPENGL 部分配置问题</h2><p><strong>GLFW_OPENGL_CORE_PROFILE</strong>:</p>
<ul>
<li>选择核心配置文件(Core Profile)。</li>
<li>核心配置文件排除了一些较旧的、不再推荐使用的 OpenGL 功能。它仅支持现代的 OpenGL 功能和特性。</li>
<li>使用核心配置文件时，必须使用现代的 OpenGL 函数和特性，例如顶点缓冲对象（VBO）、顶点数组对象（VAO）和着色器等。传统的固定管线功能（如直接使用 glBegin 和 glEnd 的绘图方法）在核心配置文件中不可用。</li>
<li>绑定VAO是强制的</li>
</ul>
<p><strong>GLFW_OPENGL_COMPAT_PROFILE</strong>:</p>
<ul>
<li>选择兼容配置文件(Compatibility Profile)。</li>
<li>兼容配置文件包含了所有 OpenGL 功能，包括新的和旧的特性。这意味着你可以在一个应用程序中使用传统的固定管线功能和现代的 OpenGL 功能。</li>
<li>兼容配置文件对于需要支持老旧硬件或依赖于传统 OpenGL 功能的应用程序很有用。</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">glfwInit</span>(); <span class="comment">// opengl 状态初始化</span></span><br><span class="line"><span class="comment">// 版本选择</span></span><br><span class="line"><span class="built_in">glfwWindowHint</span>(GLFW_CONTEXT_VERSION_MAJOR, <span class="number">3</span>);</span><br><span class="line"><span class="built_in">glfwWindowHint</span>(GLFW_CONTEXT_VERSION_MINOR, <span class="number">3</span>);</span><br><span class="line"><span class="built_in">glfwWindowHint</span>(GLFW_OPENGL_PROFILE, GLFW_OPENGL_COMPAT_PROFILE); <span class="comment">//（配置项，配置结果）</span></span><br><span class="line"><span class="comment">// glfwWindowHint(GLFW_OPENGL_PROFILE, GLFW_OPENGL_CORE_PROFILE); //（配置项，配置结果）</span></span><br></pre></td></tr></table></figure>

<h3 id="多个VBO的情况"><a href="#多个VBO的情况" class="headerlink" title="多个VBO的情况"></a>多个VBO的情况</h3><p><strong>VBO1和VBO2是两个 完全不同的缓存 为什么VBO2会覆盖掉VBO1的结果导VBO1不显示</strong></p>
<p><strong>因为锚定点的问题</strong> </p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://tryhardzhangblog.oss-us-west-1.aliyuncs.com/blog_image/image-20240726163641559.png" alt="image-20240726163641559"></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 渲染绘制</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rend</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">glBindBuffer</span>(GL_ARRAY_BUFFER, VBO);</span><br><span class="line">    <span class="comment">// glBindVertexArray(VAO);</span></span><br><span class="line">	<span class="built_in">glUseProgram</span>(shaderProgram);</span><br><span class="line">	<span class="built_in">glDrawArrays</span>(GL_TRIANGLES, <span class="number">0</span>, <span class="number">3</span>); <span class="comment">// 图形类型 第0个起始 3个</span></span><br><span class="line">	<span class="built_in">glUseProgram</span>(<span class="number">0</span>); <span class="comment">// 关掉程序</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 构建模型 完成VBO VAO</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">initModel</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">float</span> vertices[] =</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="number">-0.5f</span>, <span class="number">-0.5f</span>, <span class="number">0.0f</span>,</span><br><span class="line">		<span class="number">0.5f</span>, <span class="number">-0.5f</span>, <span class="number">0.0f</span>,</span><br><span class="line">		<span class="number">0.0f</span>, <span class="number">0.5f</span>, <span class="number">0.0f</span></span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// glGenVertexArrays(1, &amp;VAO); // 获取VAO</span></span><br><span class="line">	<span class="comment">// glBindVertexArray(VAO); // 绑定VAO</span></span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 1. 获取VBO index</span></span><br><span class="line">	<span class="built_in">glGenBuffers</span>(<span class="number">1</span>, &amp;VBO); <span class="comment">// 获取VBO的index 可以获取多个VBO index</span></span><br><span class="line">	<span class="built_in">glBindBuffer</span>(GL_ARRAY_BUFFER, VBO); <span class="comment">// 绑定哪种buffer的哪一个</span></span><br><span class="line">	<span class="built_in">glBufferData</span>(GL_ARRAY_BUFFER, <span class="built_in">sizeof</span>(vertices), vertices, GL_STATIC_DRAW); <span class="comment">// 显存分配,类型、大小、位置、如何使用数据（GL_STATIC_DRAW 模型数据不会改变)</span></span><br><span class="line">	<span class="built_in">glVertexAttribPointer</span>(<span class="number">0</span>, <span class="number">3</span>, GL_FLOAT, GL_FALSE, <span class="number">3</span> * <span class="built_in">sizeof</span>(<span class="type">float</span>), (<span class="type">void</span>*)<span class="number">0</span>); <span class="comment">// 做锚定点 layout 锚定点0，3个数据，数据类型，是否归一化，跨步步长，数据读取开始位置</span></span><br><span class="line">	<span class="built_in">glEnableVertexAttribArray</span>(<span class="number">0</span>); <span class="comment">// 激活锚定点</span></span><br><span class="line">	<span class="built_in">glBindBuffer</span>(GL_ARRAY_BUFFER, <span class="number">0</span>); <span class="comment">// 取消绑定</span></span><br><span class="line">	<span class="comment">// glBindVertexArray(0);</span></span><br><span class="line"></span><br><span class="line">	<span class="type">float</span> vertices2[] =</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="number">-0.0f</span>, <span class="number">-0.1f</span>, <span class="number">0.0f</span>,</span><br><span class="line">		<span class="number">0.5f</span>, <span class="number">-0.5f</span>, <span class="number">0.0f</span>,</span><br><span class="line">		<span class="number">0.0f</span>, <span class="number">0.5f</span>, <span class="number">0.0f</span></span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// glGenVertexArrays(1, &amp;VAO); // 获取VAO</span></span><br><span class="line">	<span class="comment">// glBindVertexArray(VAO); // 绑定VAO</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">// 1. 获取VBO index</span></span><br><span class="line">	<span class="built_in">glGenBuffers</span>(<span class="number">1</span>, &amp;VBO2); <span class="comment">// 获取VBO的index 可以获取多个VBO index</span></span><br><span class="line">	<span class="built_in">glBindBuffer</span>(GL_ARRAY_BUFFER, VBO2); <span class="comment">// 绑定哪种buffer的哪一个</span></span><br><span class="line">	<span class="built_in">glBufferData</span>(GL_ARRAY_BUFFER, <span class="built_in">sizeof</span>(vertices2), vertices2, GL_STATIC_DRAW); <span class="comment">// 显存分配,类型、大小、位置、如何使用数据（GL_STATIC_DRAW 模型数据不会改变)</span></span><br><span class="line">	<span class="built_in">glVertexAttribPointer</span>(<span class="number">0</span>, <span class="number">3</span>, GL_FLOAT, GL_FALSE, <span class="number">3</span> * <span class="built_in">sizeof</span>(<span class="type">float</span>), (<span class="type">void</span>*)<span class="number">0</span>); <span class="comment">// 做锚定点 layout 锚定点0，3个数据，数据类型，是否归一化，跨步步长，数据读取开始位置</span></span><br><span class="line">	<span class="built_in">glEnableVertexAttribArray</span>(<span class="number">0</span>); <span class="comment">// 激活锚定点</span></span><br><span class="line">	<span class="built_in">glBindBuffer</span>(GL_ARRAY_BUFFER, <span class="number">0</span>); <span class="comment">// 取消绑定</span></span><br><span class="line">	<span class="comment">// glBindVertexArray(0);</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>多个VAO VAO 记录了锚点信息 所以不需要重新设置锚点</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// 渲染绘制</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rend</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">glBindVertexArray</span>(VAO);</span><br><span class="line">	<span class="comment">//glBindBuffer(GL_ARRAY_BUFFER, VBO);</span></span><br><span class="line">	<span class="built_in">glUseProgram</span>(shaderProgram);</span><br><span class="line">	<span class="built_in">glDrawArrays</span>(GL_TRIANGLES, <span class="number">0</span>, <span class="number">3</span>); <span class="comment">// 图形类型 第0个起始 3个</span></span><br><span class="line">	<span class="built_in">glUseProgram</span>(<span class="number">0</span>); <span class="comment">// 关掉程序</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">glBindVertexArray</span>(VAO2);</span><br><span class="line">	<span class="comment">//glBindBuffer(GL_ARRAY_BUFFER, VBO);</span></span><br><span class="line">	<span class="built_in">glUseProgram</span>(shaderProgram);</span><br><span class="line">	<span class="built_in">glDrawArrays</span>(GL_TRIANGLES, <span class="number">0</span>, <span class="number">3</span>); <span class="comment">// 图形类型 第0个起始 3个</span></span><br><span class="line">	<span class="built_in">glUseProgram</span>(<span class="number">0</span>); <span class="comment">// 关掉程序</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 构建模型 完成VBO VAO</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">initModel</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">float</span> vertices[] =</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="number">-0.5f</span>, <span class="number">-0.5f</span>, <span class="number">0.0f</span>,</span><br><span class="line">		<span class="number">0.5f</span>, <span class="number">-0.5f</span>, <span class="number">0.0f</span>,</span><br><span class="line">		<span class="number">0.0f</span>, <span class="number">0.5f</span>, <span class="number">0.0f</span></span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">glGenVertexArrays</span>(<span class="number">1</span>, &amp;VAO); <span class="comment">// 获取VAO</span></span><br><span class="line">	<span class="built_in">glBindVertexArray</span>(VAO); <span class="comment">// 绑定VAO</span></span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 1. 获取VBO index</span></span><br><span class="line">	<span class="built_in">glGenBuffers</span>(<span class="number">1</span>, &amp;VBO); <span class="comment">// 获取VBO的index 可以获取多个VBO index</span></span><br><span class="line">	<span class="built_in">glBindBuffer</span>(GL_ARRAY_BUFFER, VBO); <span class="comment">// 绑定哪种buffer的哪一个</span></span><br><span class="line">	<span class="built_in">glBufferData</span>(GL_ARRAY_BUFFER, <span class="built_in">sizeof</span>(vertices), vertices, GL_STATIC_DRAW); <span class="comment">// 显存分配,类型、大小、位置、如何使用数据（GL_STATIC_DRAW 模型数据不会改变)</span></span><br><span class="line">	<span class="built_in">glVertexAttribPointer</span>(<span class="number">0</span>, <span class="number">3</span>, GL_FLOAT, GL_FALSE, <span class="number">3</span> * <span class="built_in">sizeof</span>(<span class="type">float</span>), (<span class="type">void</span>*)<span class="number">0</span>); <span class="comment">// 做锚定点 layout 锚定点0，3个数据，数据类型，是否归一化，跨步步长，数据读取开始位置</span></span><br><span class="line">	<span class="built_in">glEnableVertexAttribArray</span>(<span class="number">0</span>); <span class="comment">// 激活锚定点</span></span><br><span class="line">	<span class="built_in">glBindBuffer</span>(GL_ARRAY_BUFFER, <span class="number">0</span>); <span class="comment">// 取消绑定</span></span><br><span class="line">	<span class="built_in">glBindVertexArray</span>(<span class="number">0</span>); <span class="comment">// 结束VAO绑定</span></span><br><span class="line"></span><br><span class="line">	<span class="type">float</span> vertices2[] =</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="number">-0.0f</span>, <span class="number">-0.1f</span>, <span class="number">0.0f</span>,</span><br><span class="line">		<span class="number">0.8f</span>, <span class="number">-0.5f</span>, <span class="number">0.0f</span>,</span><br><span class="line">		<span class="number">0.0f</span>, <span class="number">0.8f</span>, <span class="number">0.0f</span></span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">glGenVertexArrays</span>(<span class="number">1</span>, &amp;VAO2); <span class="comment">// 获取VAO</span></span><br><span class="line">	<span class="built_in">glBindVertexArray</span>(VAO2); <span class="comment">// 绑定VAO</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">// 1. 获取VBO index</span></span><br><span class="line">	<span class="built_in">glGenBuffers</span>(<span class="number">1</span>, &amp;VBO2); <span class="comment">// 获取VBO的index 可以获取多个VBO index</span></span><br><span class="line">	<span class="built_in">glBindBuffer</span>(GL_ARRAY_BUFFER, VBO2); <span class="comment">// 绑定哪种buffer的哪一个</span></span><br><span class="line">	<span class="built_in">glBufferData</span>(GL_ARRAY_BUFFER, <span class="built_in">sizeof</span>(vertices2), vertices2, GL_STATIC_DRAW); <span class="comment">// 显存分配,类型、大小、位置、如何使用数据（GL_STATIC_DRAW 模型数据不会改变)</span></span><br><span class="line">	<span class="built_in">glVertexAttribPointer</span>(<span class="number">0</span>, <span class="number">3</span>, GL_FLOAT, GL_FALSE, <span class="number">3</span> * <span class="built_in">sizeof</span>(<span class="type">float</span>), (<span class="type">void</span>*)<span class="number">0</span>); <span class="comment">// 做锚定点 layout 锚定点0，3个数据，数据类型，是否归一化，跨步步长，数据读取开始位置</span></span><br><span class="line">	<span class="built_in">glEnableVertexAttribArray</span>(<span class="number">0</span>); <span class="comment">// 激活锚定点</span></span><br><span class="line">	<span class="built_in">glBindBuffer</span>(GL_ARRAY_BUFFER, <span class="number">0</span>); <span class="comment">// 取消绑定</span></span><br><span class="line">	<span class="built_in">glBindVertexArray</span>(<span class="number">0</span>); <span class="comment">// 结束VAO绑定</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="Shader与C-传输"><a href="#Shader与C-传输" class="headerlink" title="Shader与C++传输"></a>Shader与C++传输</h3><p><strong>uniform变量有限 定义了uniform如果未使用会被系统删除</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 渲染绘制</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rend</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">glUseProgram</span>(shaderProgram); <span class="comment">// 提前启用</span></span><br><span class="line">	<span class="type">float</span> _time = <span class="built_in">glfwGetTime</span>();</span><br><span class="line">	<span class="type">float</span> _green = <span class="built_in">sin</span>(_time) * <span class="number">0.5f</span> + <span class="number">0.5f</span>;</span><br><span class="line">	<span class="type">int</span> _location = <span class="built_in">glGetUniformLocation</span>(shaderProgram, <span class="string">&quot;ourColor&quot;</span>); <span class="comment">// 从已经构建好滴shader程序获取变量</span></span><br><span class="line">	<span class="built_in">glUniform4f</span>(_location, <span class="number">0.0f</span>, _green, <span class="number">0.0f</span>, <span class="number">1.0f</span>); <span class="comment">// 4f：传输4个float</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">glBindVertexArray</span>(VAO);</span><br><span class="line">	<span class="comment">//glBindBuffer(GL_ARRAY_BUFFER, VBO);</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">glDrawArrays</span>(GL_TRIANGLES, <span class="number">0</span>, <span class="number">3</span>); <span class="comment">// 图形类型 第0个起始 3个</span></span><br><span class="line">	<span class="built_in">glUseProgram</span>(<span class="number">0</span>); <span class="comment">// 关掉程序</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="顶点索引"><a href="#顶点索引" class="headerlink" title="顶点索引"></a>顶点索引</h3><p><strong>剔除重复顶点 传输顶点索引 VBO VAO</strong></p>
<h3 id="EBO-Element-Buffer-Object"><a href="#EBO-Element-Buffer-Object" class="headerlink" title="EBO Element Buffer Object"></a>EBO Element Buffer Object</h3><p>EBOs are a powerful tool in OpenGL that enhance the efficiency and flexibility of rendering operations. They are especially useful for complex models and animations, allowing for more compact and efficient data representation and manipulation.</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://tryhardzhangblog.oss-us-west-1.aliyuncs.com/blog_image/image-20240729112647758.png" alt="image-20240729112647758"></p>
<h2 id="Texture"><a href="#Texture" class="headerlink" title="Texture"></a>Texture</h2><h3 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h3><p>定义UV坐标 获取插值结果 与实际坐标相乘 获得实际插值</p>
<h3 id="STB-IMAGE-读取图片"><a href="#STB-IMAGE-读取图片" class="headerlink" title="STB_IMAGE 读取图片"></a>STB_IMAGE 读取图片</h3><ol>
<li><p>**<code>stbi_load</code>**从文件中加载图像，并返回图像数据的指针，同时提供图像的宽度、高度和通道数。</p>
</li>
<li><p>**<code>stbi_load_from_memory</code>**从内存中加载图像数据，适用于已经在内存中的图像。</p>
</li>
<li><p>**<code>stbi_load_from_file</code>**从文件指针加载图像，类似于 <code>stbi_load</code>，但使用 <code>FILE*</code> 作为输入。</p>
</li>
<li><p>**<code>stbi_load_from_callbacks</code>**使用自定义回调接口加载图像，适用于自定义的输入&#x2F;输出系统。</p>
</li>
<li><p>**<code>stbi_image_free</code>**释放由 <code>stbi_load</code> 系列函数分配的图像数据内存。</p>
</li>
<li><p>**<code>stbi_info</code>**获取图像的基本信息（宽度、高度、通道数）而不加载图像数据。</p>
</li>
<li><p>**<code>stbi_set_flip_vertically_on_load</code>**设置在加载图像时是否垂直翻转图像的标志。</p>
</li>
<li><p>**<code>stbi_failure_reason</code>**返回最后一次失败的原因描述。</p>
</li>
<li><p>**<code>stbi_is_hdr</code>**检查图像文件是否为 HDR（高动态范围）图像。</p>
</li>
<li><p>**<code>stbi_loadf</code>**加载 HDR 图像，并以浮点数据的形式返回图像数据。</p>
</li>
</ol>
<h3 id="Texture-Wrapping"><a href="#Texture-Wrapping" class="headerlink" title="Texture Wrapping"></a>Texture Wrapping</h3><p>坐标超出0-1的范围 需要重复采样</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://tryhardzhangblog.oss-us-west-1.aliyuncs.com/blog_image/image-20240729145015630.png" alt="image-20240729145015630"></p>
<h3 id="Texture-Filter"><a href="#Texture-Filter" class="headerlink" title="Texture Filter"></a>Texture Filter</h3><p>通过<code>u*width</code>和<code>v*height</code> 获取坐标位小数 需要取整</p>
<p>Nearest  找最近的点 bilinear 找四个求平均值</p>
<p>图片小使用nearest 因为像素差异变大</p>
<p>图片大使用bilinear 更加平滑</p>
<h2 id="摄像机"><a href="#摄像机" class="headerlink" title="摄像机"></a>摄像机</h2><h3 id="摄像机矩阵"><a href="#摄像机矩阵" class="headerlink" title="摄像机矩阵"></a>摄像机矩阵</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">glUniformMatrix4fv</span>(<span class="built_in">glGetUniformLocation</span>(m_shaderProgram, _name.<span class="built_in">c_str</span>()), <span class="number">1</span>, GL_FALSE, glm::<span class="built_in">value_ptr</span>(_matrix));</span><br></pre></td></tr></table></figure>

<p>glGetUniformLocation获取当前_name变量的shader或锚定符</p>
<p>glUniformMatrix4fv 向shader的location传入数据  GL_FALSE(列优先)</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">glm::<span class="built_in">lookAt</span>&lt;<span class="type">float</span>, glm::packed_highp&gt;(<span class="type">const</span> glm::highp_vec3 &amp;eye, <span class="type">const</span> glm::highp_vec3 &amp;center, </span><br><span class="line">    <span class="type">const</span> glm::highp_vec3 &amp;up) <span class="comment">// 正交投影</span></span><br></pre></td></tr></table></figure>

<h4 id="初始呈像"><a href="#初始呈像" class="headerlink" title="初始呈像"></a>初始呈像</h4><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://tryhardzhangblog.oss-us-west-1.aliyuncs.com/blog_image/image-20240730105833151.png" alt="image-20240730105833151" style="zoom:50%;" />

<h4 id="Lookat角度-并没有开启深度检测"><a href="#Lookat角度-并没有开启深度检测" class="headerlink" title="Lookat角度 并没有开启深度检测"></a>Lookat角度 并没有开启深度检测</h4><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://tryhardzhangblog.oss-us-west-1.aliyuncs.com/blog_image/image-20240730110045717.png" alt="image-20240730110045717" style="zoom:50%;" />

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">glClearColor</span>(<span class="number">0.2f</span>, <span class="number">0.3f</span>, <span class="number">0.3f</span>, <span class="number">1.0f</span>); <span class="comment">// 设置清除颜色</span></span><br><span class="line"><span class="built_in">glClear</span>(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT); <span class="comment">// 清除画布颜色， GL_COLOR_BUFFER_BIT是下一帧要显示的所有像素信息</span></span><br><span class="line"><span class="built_in">glEnable</span>(GL_DEPTH_TEST);</span><br></pre></td></tr></table></figure>

<h4 id="加入深度检测后"><a href="#加入深度检测后" class="headerlink" title="加入深度检测后"></a>加入深度检测后</h4><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://tryhardzhangblog.oss-us-west-1.aliyuncs.com/blog_image/1f706e2c617d71f42aab1f5cc26f615.png" alt="1f706e2c617d71f42aab1f5cc26f615" style="zoom:50%;" />

<h3 id="摄像机的移动旋转"><a href="#摄像机的移动旋转" class="headerlink" title="摄像机的移动旋转"></a>摄像机的移动旋转</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// 渲染绘制</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rend</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">glClearColor</span>(<span class="number">0.2f</span>, <span class="number">0.3f</span>, <span class="number">0.3f</span>, <span class="number">1.0f</span>); <span class="comment">// 设置清除颜色</span></span><br><span class="line">	<span class="built_in">glClear</span>(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT); <span class="comment">// 清除画布颜色， GL_COLOR_BUFFER_BIT是下一帧要显示的所有像素信息</span></span><br><span class="line">	<span class="built_in">glEnable</span>(GL_DEPTH_TEST);</span><br><span class="line"></span><br><span class="line">	glm::vec3 modelVecs[] = &#123;</span><br><span class="line">	glm::<span class="built_in">vec3</span>(<span class="number">0.0f</span>,  <span class="number">0.0f</span>,  <span class="number">0.0f</span>),</span><br><span class="line">	glm::<span class="built_in">vec3</span>(<span class="number">2.0f</span>,  <span class="number">5.0f</span>, <span class="number">-15.0f</span>),</span><br><span class="line">	glm::<span class="built_in">vec3</span>(<span class="number">-1.5f</span>, <span class="number">-2.2f</span>, <span class="number">-2.5f</span>),</span><br><span class="line">	glm::<span class="built_in">vec3</span>(<span class="number">-3.8f</span>, <span class="number">-2.0f</span>, <span class="number">-12.3f</span>),</span><br><span class="line">	glm::<span class="built_in">vec3</span>(<span class="number">2.4f</span>, <span class="number">-0.4f</span>, <span class="number">-3.5f</span>),</span><br><span class="line">	glm::<span class="built_in">vec3</span>(<span class="number">-1.7f</span>,  <span class="number">3.0f</span>, <span class="number">-7.5f</span>),</span><br><span class="line">	glm::<span class="built_in">vec3</span>(<span class="number">1.3f</span>, <span class="number">-2.0f</span>, <span class="number">-2.5f</span>),</span><br><span class="line">	glm::<span class="built_in">vec3</span>(<span class="number">1.5f</span>,  <span class="number">2.0f</span>, <span class="number">-2.5f</span>),</span><br><span class="line">	glm::<span class="built_in">vec3</span>(<span class="number">1.5f</span>,  <span class="number">0.2f</span>, <span class="number">-1.5f</span>),</span><br><span class="line">	glm::<span class="built_in">vec3</span>(<span class="number">-1.3f</span>,  <span class="number">1.0f</span>, <span class="number">-1.5f</span>)</span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 摄像机矩阵</span></span><br><span class="line">	_viewMatrix = glm::<span class="built_in">lookAt</span>(glm::<span class="built_in">vec3</span>(<span class="number">0.0f</span>, <span class="number">0.0f</span>, <span class="number">3.0f</span>), glm::<span class="built_in">vec3</span>(<span class="number">0.0f</span>, <span class="number">0.0f</span>, <span class="number">0.0f</span>), glm::<span class="built_in">vec3</span>(<span class="number">0.0f</span>, <span class="number">1.0f</span>, <span class="number">0.0f</span>));</span><br><span class="line">	_projMatrix = glm::<span class="built_in">perspective</span>(glm::<span class="built_in">radians</span>(<span class="number">45.0f</span>), (<span class="type">float</span>)_width / (<span class="type">float</span>)_height, <span class="number">0.1f</span>, <span class="number">100.0f</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">glBindTexture</span>(GL_TEXTURE_2D, _texture);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 画十个立方体</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		glm::mat4 _modelMatrix(<span class="number">1.0f</span>);</span><br><span class="line">		_modelMatrix = glm::<span class="built_in">translate</span>(_modelMatrix, modelVecs[i]); <span class="comment">//平移</span></span><br><span class="line">		</span><br><span class="line">		_shader.<span class="built_in">start</span>();</span><br><span class="line">		_shader.<span class="built_in">setMatrix</span>(<span class="string">&quot;_modelMatrix&quot;</span>, _modelMatrix);</span><br><span class="line">		_shader.<span class="built_in">setMatrix</span>(<span class="string">&quot;_viewMatrix&quot;</span>, _viewMatrix);</span><br><span class="line">		_shader.<span class="built_in">setMatrix</span>(<span class="string">&quot;_projMatrix&quot;</span>, _projMatrix);</span><br><span class="line">		<span class="built_in">glBindVertexArray</span>(VAO);</span><br><span class="line">		<span class="comment">//glBindBuffer(GL_ARRAY_BUFFER, VBO);</span></span><br><span class="line">		<span class="built_in">glDrawArrays</span>(GL_TRIANGLES, <span class="number">0</span>, <span class="number">36</span>); <span class="comment">// 图形类型 第0个起始 3个</span></span><br><span class="line">		<span class="comment">// glDrawElements(GL_TRIANGLES, 6, GL_UNSIGNED_INT, 0);</span></span><br><span class="line">		_shader.<span class="built_in">end</span>(); <span class="comment">// 关掉程序</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://tryhardzhangblog.oss-us-west-1.aliyuncs.com/blog_image/image-20240730114754720.png" alt="image-20240730114754720" style="zoom: 50%;" />

<h4 id="Rotate-move运算规则"><a href="#Rotate-move运算规则" class="headerlink" title="Rotate move运算规则"></a>Rotate move运算规则</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://tryhardzhangblog.oss-us-west-1.aliyuncs.com/blog_image/image-20240730120042651.png" alt="image-20240730120042651"></p>
<p>rotate矩阵在右边 </p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://tryhardzhangblog.oss-us-west-1.aliyuncs.com/blog_image/image-20240730120336423.png" alt="image-20240730120336423" style="zoom:50%;" />

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">rend</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">glClearColor</span>(<span class="number">0.2f</span>, <span class="number">0.3f</span>, <span class="number">0.3f</span>, <span class="number">1.0f</span>); <span class="comment">// 设置清除颜色</span></span><br><span class="line">	<span class="built_in">glClear</span>(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT); <span class="comment">// 清除画布颜色， GL_COLOR_BUFFER_BIT是下一帧要显示的所有像素信息</span></span><br><span class="line">	<span class="built_in">glEnable</span>(GL_DEPTH_TEST);</span><br><span class="line"></span><br><span class="line">	glm::vec3 modelVecs[] = &#123;</span><br><span class="line">	glm::<span class="built_in">vec3</span>(<span class="number">0.0f</span>,  <span class="number">0.0f</span>,  <span class="number">0.0f</span>),</span><br><span class="line">	glm::<span class="built_in">vec3</span>(<span class="number">2.0f</span>,  <span class="number">5.0f</span>, <span class="number">-15.0f</span>),</span><br><span class="line">	glm::<span class="built_in">vec3</span>(<span class="number">-1.5f</span>, <span class="number">-2.2f</span>, <span class="number">-2.5f</span>),</span><br><span class="line">	glm::<span class="built_in">vec3</span>(<span class="number">-3.8f</span>, <span class="number">-2.0f</span>, <span class="number">-12.3f</span>),</span><br><span class="line">	glm::<span class="built_in">vec3</span>(<span class="number">2.4f</span>, <span class="number">-0.4f</span>, <span class="number">-3.5f</span>),</span><br><span class="line">	glm::<span class="built_in">vec3</span>(<span class="number">-1.7f</span>,  <span class="number">3.0f</span>, <span class="number">-7.5f</span>),</span><br><span class="line">	glm::<span class="built_in">vec3</span>(<span class="number">1.3f</span>, <span class="number">-2.0f</span>, <span class="number">-2.5f</span>),</span><br><span class="line">	glm::<span class="built_in">vec3</span>(<span class="number">1.5f</span>,  <span class="number">2.0f</span>, <span class="number">-2.5f</span>),</span><br><span class="line">	glm::<span class="built_in">vec3</span>(<span class="number">1.5f</span>,  <span class="number">0.2f</span>, <span class="number">-1.5f</span>),</span><br><span class="line">	glm::<span class="built_in">vec3</span>(<span class="number">-1.3f</span>,  <span class="number">1.0f</span>, <span class="number">-1.5f</span>)</span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 摄像机矩阵</span></span><br><span class="line">	_viewMatrix = glm::<span class="built_in">lookAt</span>(glm::<span class="built_in">vec3</span>(<span class="number">0.0f</span>, <span class="number">0.0f</span>, <span class="number">3.0f</span>), glm::<span class="built_in">vec3</span>(<span class="number">0.0f</span>, <span class="number">0.0f</span>, <span class="number">0.0f</span>), glm::<span class="built_in">vec3</span>(<span class="number">0.0f</span>, <span class="number">1.0f</span>, <span class="number">0.0f</span>));</span><br><span class="line">	_projMatrix = glm::<span class="built_in">perspective</span>(glm::<span class="built_in">radians</span>(<span class="number">45.0f</span>), (<span class="type">float</span>)_width / (<span class="type">float</span>)_height, <span class="number">0.1f</span>, <span class="number">100.0f</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">glBindTexture</span>(GL_TEXTURE_2D, _texture);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 画十个立方体</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		glm::mat4 _modelMatrix(<span class="number">1.0f</span>);</span><br><span class="line">		_modelMatrix = glm::<span class="built_in">translate</span>(_modelMatrix, modelVecs[i]); <span class="comment">//平移</span></span><br><span class="line">		_modelMatrix = glm::<span class="built_in">rotate</span>(_modelMatrix, glm::<span class="built_in">radians</span>((<span class="type">float</span>)<span class="built_in">glfwGetTime</span>() * (i+<span class="number">1</span>) * <span class="number">10</span>), glm::<span class="built_in">vec3</span>(<span class="number">0.0f</span>, <span class="number">1.0f</span>, <span class="number">0.0f</span>));</span><br><span class="line"></span><br><span class="line">		_shader.<span class="built_in">start</span>();</span><br><span class="line">		_shader.<span class="built_in">setMatrix</span>(<span class="string">&quot;_modelMatrix&quot;</span>, _modelMatrix);</span><br><span class="line">		_shader.<span class="built_in">setMatrix</span>(<span class="string">&quot;_viewMatrix&quot;</span>, _viewMatrix);</span><br><span class="line">		_shader.<span class="built_in">setMatrix</span>(<span class="string">&quot;_projMatrix&quot;</span>, _projMatrix);</span><br><span class="line">		<span class="built_in">glBindVertexArray</span>(VAO);</span><br><span class="line">		<span class="comment">//glBindBuffer(GL_ARRAY_BUFFER, VBO);</span></span><br><span class="line">		<span class="built_in">glDrawArrays</span>(GL_TRIANGLES, <span class="number">0</span>, <span class="number">36</span>); <span class="comment">// 图形类型 第0个起始 3个</span></span><br><span class="line">		<span class="comment">// glDrawElements(GL_TRIANGLES, 6, GL_UNSIGNED_INT, 0);</span></span><br><span class="line">		_shader.<span class="built_in">end</span>(); <span class="comment">// 关掉程序</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="LookAt作用"><a href="#LookAt作用" class="headerlink" title="LookAt作用"></a>LookAt作用</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://tryhardzhangblog.oss-us-west-1.aliyuncs.com/blog_image/image-20240730121846652.png" alt="image-20240730121846652"></p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://tryhardzhangblog.oss-us-west-1.aliyuncs.com/blog_image/image-20240730140845075.png" alt="image-20240730140845075" style="zoom:67%;" />

<p>cameraPos - cameraTarget 由减数到被减数的向量</p>
<p>cameraFront需要是一个单位向量</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://tryhardzhangblog.oss-us-west-1.aliyuncs.com/blog_image/image-20240730142937534.png" alt="image-20240730142937534"></p>
<p>processInput每次循环都会被调用 检测是否使用按键</p>
<h4 id="camera-cpp"><a href="#camera-cpp" class="headerlink" title="camera.cpp"></a>camera.cpp</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Camera.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Camera::lookAt</span><span class="params">(glm::vec3 _pos, glm::vec3 _front, glm::vec3 _up)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	m_position = _pos;</span><br><span class="line">	m_front = glm::<span class="built_in">normalize</span>(_front);</span><br><span class="line">	m_up = _up;</span><br><span class="line"></span><br><span class="line">	m_vMatrix = glm::<span class="built_in">lookAt</span>(m_position, m_position + m_front, m_up);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Camera::update</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	m_vMatrix = glm::<span class="built_in">lookAt</span>(m_position, m_position + m_front, m_up);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">glm::mat4 <span class="title">Camera::getMatrix</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> m_vMatrix;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Camera::move</span><span class="params">(CAMERA_MOVE _mode)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">switch</span> (_mode)</span><br><span class="line">	&#123;</span><br><span class="line">	<span class="keyword">case</span> CAMERA_MOVE::MOVE_LEFT:</span><br><span class="line">		m_position -= glm::<span class="built_in">normalize</span>(glm::<span class="built_in">cross</span>(m_front, m_up)) * m_speed;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> CAMERA_MOVE::MOVE_RIGHT:</span><br><span class="line">		m_position += glm::<span class="built_in">normalize</span>(glm::<span class="built_in">cross</span>(m_front, m_up)) * m_speed;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> CAMERA_MOVE::MOVE_FRONT:</span><br><span class="line">		m_position += m_speed * m_front;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> CAMERA_MOVE::MOVE_BACK:</span><br><span class="line">		m_position -= m_speed * m_front;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">default</span>:</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 当有任何输入时 比如键盘或鼠标事件</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">processInput</span><span class="params">(GLFWwindow* window)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (<span class="built_in">glfwGetKey</span>(window, GLFW_KEY_ESCAPE) == GLFW_PRESS)</span><br><span class="line">		<span class="built_in">glfwSetWindowShouldClose</span>(window, <span class="literal">true</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> (<span class="built_in">glfwGetKey</span>(window, GLFW_KEY_W) == GLFW_PRESS)</span><br><span class="line">	&#123;</span><br><span class="line">		_camera.<span class="built_in">move</span>(CAMERA_MOVE::MOVE_FRONT);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (<span class="built_in">glfwGetKey</span>(window, GLFW_KEY_S) == GLFW_PRESS)</span><br><span class="line">	&#123;</span><br><span class="line">		_camera.<span class="built_in">move</span>(CAMERA_MOVE::MOVE_BACK);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (<span class="built_in">glfwGetKey</span>(window, GLFW_KEY_A) == GLFW_PRESS)</span><br><span class="line">	&#123;</span><br><span class="line">		_camera.<span class="built_in">move</span>(CAMERA_MOVE::MOVE_LEFT);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (<span class="built_in">glfwGetKey</span>(window, GLFW_KEY_D) == GLFW_PRESS)</span><br><span class="line">	&#123;</span><br><span class="line">		_camera.<span class="built_in">move</span>(CAMERA_MOVE::MOVE_RIGHT);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="摄像机转动"><a href="#摄像机转动" class="headerlink" title="摄像机转动"></a>摄像机转动</h3><h4 id="pitch-yaw-and-roll"><a href="#pitch-yaw-and-roll" class="headerlink" title="pitch yaw and roll"></a>pitch yaw and roll</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://tryhardzhangblog.oss-us-west-1.aliyuncs.com/blog_image/image-20240730155713477.png" alt="image-20240730155713477"></p>
<p>yaw x的正方向走向z的正方向为yaw的正值</p>
<p>yaw x的正方向走向z的负方向是负值</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://tryhardzhangblog.oss-us-west-1.aliyuncs.com/blog_image/image-20240730185904041.png" alt="image-20240730185904041" style="zoom: 67%;" /><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://tryhardzhangblog.oss-us-west-1.aliyuncs.com/blog_image/image-20240730185923378.png" alt="image-20240730185923378" style="zoom: 67%;" /></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">Camera::pitch</span><span class="params">(<span class="type">float</span> _yOffset)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	m_pitch += _yOffset * m_sensitivity;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (m_pitch &gt;= <span class="number">89.0f</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		m_pitch = <span class="number">89.0f</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (m_pitch &lt;= <span class="number">-89.0f</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		m_pitch = <span class="number">-89.0f</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	m_front.y = <span class="built_in">sin</span>(glm::<span class="built_in">radians</span>(m_pitch));</span><br><span class="line">	m_front.x = <span class="built_in">cos</span>(glm::<span class="built_in">radians</span>(m_yaw)) * <span class="built_in">cos</span>(glm::<span class="built_in">radians</span>(m_pitch));</span><br><span class="line">	m_front.z = <span class="built_in">sin</span>(glm::<span class="built_in">radians</span>(m_yaw)) * <span class="built_in">cos</span>(glm::<span class="built_in">radians</span>(m_pitch));</span><br><span class="line"></span><br><span class="line">	<span class="built_in">update</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Camera::yaw</span><span class="params">(<span class="type">float</span> _x0ffset)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	m_yaw += _x0ffset * m_sensitivity;</span><br><span class="line"></span><br><span class="line">	m_front.y = <span class="built_in">sin</span>(glm::<span class="built_in">radians</span>(m_pitch));</span><br><span class="line">	m_front.x = <span class="built_in">cos</span>(glm::<span class="built_in">radians</span>(m_yaw)) * <span class="built_in">cos</span>(glm::<span class="built_in">radians</span>(m_pitch));</span><br><span class="line">	m_front.z = <span class="built_in">sin</span>(glm::<span class="built_in">radians</span>(m_yaw)) * <span class="built_in">cos</span>(glm::<span class="built_in">radians</span>(m_pitch));</span><br><span class="line"></span><br><span class="line">	<span class="built_in">update</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Camera::setSentivity</span><span class="params">(<span class="type">float</span> _s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	m_sensitivity = _s;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://tryhardzhangblog.oss-us-west-1.aliyuncs.com/blog_image/image-20240730190433724.png" alt="image-20240730190433724" style="zoom: 50%;" />

<p>需要检测是不是firstmove 记录开始的坐标 先记录再对比再剪除</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">Camera::onMouseMove</span><span class="params">(<span class="type">double</span> _xpos, <span class="type">double</span> _ypos)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (m_firstMove)</span><br><span class="line">	&#123;</span><br><span class="line">		m_xpos = _xpos;</span><br><span class="line">		m_ypos = _ypos;</span><br><span class="line">		m_firstMove = <span class="literal">false</span>;</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="type">float</span> _xOffset = _xpos - m_xpos;</span><br><span class="line">	<span class="type">float</span> _yOffset = -(_ypos - m_ypos);</span><br><span class="line"></span><br><span class="line">	m_xpos = _xpos;</span><br><span class="line">	m_ypos = _ypos;</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">pitch</span>(_yOffset);</span><br><span class="line">	<span class="built_in">yaw</span>(_xOffset);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>windows 的窗体位置再左上角 向上坐标减小 向下坐标增大 所以会相反</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Base.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Shader.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ffImage.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Camera.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> VBO = <span class="number">0</span>;</span><br><span class="line"><span class="type">unsigned</span> VAO = <span class="number">0</span>;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> _texture = <span class="number">0</span>;</span><br><span class="line">ffImage* _pImage = <span class="literal">NULL</span>;</span><br><span class="line">Shader _shader;</span><br><span class="line">Camera _camera;</span><br><span class="line"></span><br><span class="line">glm::mat4 _viewMatrix(<span class="number">1.0f</span>);</span><br><span class="line">glm::mat4 _projMatrix(<span class="number">1.0f</span>);</span><br><span class="line"><span class="type">int</span>		  _width = <span class="number">800</span>;</span><br><span class="line"><span class="type">int</span>		  _height = <span class="number">600</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 渲染绘制</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rend</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">glClearColor</span>(<span class="number">0.2f</span>, <span class="number">0.3f</span>, <span class="number">0.3f</span>, <span class="number">1.0f</span>); <span class="comment">// 设置清除颜色</span></span><br><span class="line">	<span class="built_in">glClear</span>(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT); <span class="comment">// 清除画布颜色， GL_COLOR_BUFFER_BIT是下一帧要显示的所有像素信息</span></span><br><span class="line">	<span class="built_in">glEnable</span>(GL_DEPTH_TEST);</span><br><span class="line"></span><br><span class="line">	glm::vec3 modelVecs[] = &#123;</span><br><span class="line">	glm::<span class="built_in">vec3</span>(<span class="number">0.0f</span>,  <span class="number">0.0f</span>,  <span class="number">0.0f</span>),</span><br><span class="line">	glm::<span class="built_in">vec3</span>(<span class="number">2.0f</span>,  <span class="number">5.0f</span>, <span class="number">-15.0f</span>),</span><br><span class="line">	glm::<span class="built_in">vec3</span>(<span class="number">-1.5f</span>, <span class="number">-2.2f</span>, <span class="number">-2.5f</span>),</span><br><span class="line">	glm::<span class="built_in">vec3</span>(<span class="number">-3.8f</span>, <span class="number">-2.0f</span>, <span class="number">-12.3f</span>),</span><br><span class="line">	glm::<span class="built_in">vec3</span>(<span class="number">2.4f</span>, <span class="number">-0.4f</span>, <span class="number">-3.5f</span>),</span><br><span class="line">	glm::<span class="built_in">vec3</span>(<span class="number">-1.7f</span>,  <span class="number">3.0f</span>, <span class="number">-7.5f</span>),</span><br><span class="line">	glm::<span class="built_in">vec3</span>(<span class="number">1.3f</span>, <span class="number">-2.0f</span>, <span class="number">-2.5f</span>),</span><br><span class="line">	glm::<span class="built_in">vec3</span>(<span class="number">1.5f</span>,  <span class="number">2.0f</span>, <span class="number">-2.5f</span>),</span><br><span class="line">	glm::<span class="built_in">vec3</span>(<span class="number">1.5f</span>,  <span class="number">0.2f</span>, <span class="number">-1.5f</span>),</span><br><span class="line">	glm::<span class="built_in">vec3</span>(<span class="number">-1.3f</span>,  <span class="number">1.0f</span>, <span class="number">-1.5f</span>)</span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 摄像机矩阵</span></span><br><span class="line">	_camera.<span class="built_in">update</span>();</span><br><span class="line">	<span class="comment">// _viewMatrix = glm::lookAt(glm::vec3(0.0f, 0.0f, 3.0f), glm::vec3(0.0f, 0.0f, 0.0f), glm::vec3(0.0f, 1.0f, 0.0f));</span></span><br><span class="line">	_projMatrix = glm::<span class="built_in">perspective</span>(glm::<span class="built_in">radians</span>(<span class="number">45.0f</span>), (<span class="type">float</span>)_width / (<span class="type">float</span>)_height, <span class="number">0.1f</span>, <span class="number">100.0f</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">glBindTexture</span>(GL_TEXTURE_2D, _texture);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 画十个立方体</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		glm::mat4 _modelMatrix(<span class="number">1.0f</span>);</span><br><span class="line">		_modelMatrix = glm::<span class="built_in">translate</span>(_modelMatrix, modelVecs[i]); <span class="comment">//平移</span></span><br><span class="line">		_modelMatrix = glm::<span class="built_in">rotate</span>(_modelMatrix, glm::<span class="built_in">radians</span>((<span class="type">float</span>)<span class="built_in">glfwGetTime</span>() * (i+<span class="number">1</span>) * <span class="number">10</span>), glm::<span class="built_in">vec3</span>(<span class="number">0.0f</span>, <span class="number">1.0f</span>, <span class="number">0.0f</span>));</span><br><span class="line"></span><br><span class="line">		_shader.<span class="built_in">start</span>();</span><br><span class="line">		_shader.<span class="built_in">setMatrix</span>(<span class="string">&quot;_modelMatrix&quot;</span>, _modelMatrix);</span><br><span class="line">		_shader.<span class="built_in">setMatrix</span>(<span class="string">&quot;_viewMatrix&quot;</span>, _camera.<span class="built_in">getMatrix</span>());</span><br><span class="line">		_shader.<span class="built_in">setMatrix</span>(<span class="string">&quot;_projMatrix&quot;</span>, _projMatrix);</span><br><span class="line">		<span class="built_in">glBindVertexArray</span>(VAO);</span><br><span class="line">		<span class="comment">//glBindBuffer(GL_ARRAY_BUFFER, VBO);</span></span><br><span class="line">		<span class="built_in">glDrawArrays</span>(GL_TRIANGLES, <span class="number">0</span>, <span class="number">36</span>); <span class="comment">// 图形类型 第0个起始 3个</span></span><br><span class="line">		<span class="comment">// glDrawElements(GL_TRIANGLES, 6, GL_UNSIGNED_INT, 0);</span></span><br><span class="line">		_shader.<span class="built_in">end</span>(); <span class="comment">// 关掉程序</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 构建模型 完成VBO VAO</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">initModel</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">float</span> vertices[] = &#123;</span><br><span class="line">		<span class="number">-0.5f</span>, <span class="number">-0.5f</span>, <span class="number">-0.5f</span>,  <span class="number">0.0f</span>, <span class="number">0.0f</span>,</span><br><span class="line">		 <span class="number">0.5f</span>, <span class="number">-0.5f</span>, <span class="number">-0.5f</span>,  <span class="number">1.0f</span>, <span class="number">0.0f</span>,</span><br><span class="line">		 <span class="number">0.5f</span>,  <span class="number">0.5f</span>, <span class="number">-0.5f</span>,  <span class="number">1.0f</span>, <span class="number">1.0f</span>,</span><br><span class="line">		 <span class="number">0.5f</span>,  <span class="number">0.5f</span>, <span class="number">-0.5f</span>,  <span class="number">1.0f</span>, <span class="number">1.0f</span>,</span><br><span class="line">		<span class="number">-0.5f</span>,  <span class="number">0.5f</span>, <span class="number">-0.5f</span>,  <span class="number">0.0f</span>, <span class="number">1.0f</span>,</span><br><span class="line">		<span class="number">-0.5f</span>, <span class="number">-0.5f</span>, <span class="number">-0.5f</span>,  <span class="number">0.0f</span>, <span class="number">0.0f</span>,</span><br><span class="line"></span><br><span class="line">		<span class="number">-0.5f</span>, <span class="number">-0.5f</span>,  <span class="number">0.5f</span>,  <span class="number">0.0f</span>, <span class="number">0.0f</span>,</span><br><span class="line">		 <span class="number">0.5f</span>, <span class="number">-0.5f</span>,  <span class="number">0.5f</span>,  <span class="number">1.0f</span>, <span class="number">0.0f</span>,</span><br><span class="line">		 <span class="number">0.5f</span>,  <span class="number">0.5f</span>,  <span class="number">0.5f</span>,  <span class="number">1.0f</span>, <span class="number">1.0f</span>,</span><br><span class="line">		 <span class="number">0.5f</span>,  <span class="number">0.5f</span>,  <span class="number">0.5f</span>,  <span class="number">1.0f</span>, <span class="number">1.0f</span>,</span><br><span class="line">		<span class="number">-0.5f</span>,  <span class="number">0.5f</span>,  <span class="number">0.5f</span>,  <span class="number">0.0f</span>, <span class="number">1.0f</span>,</span><br><span class="line">		<span class="number">-0.5f</span>, <span class="number">-0.5f</span>,  <span class="number">0.5f</span>,  <span class="number">0.0f</span>, <span class="number">0.0f</span>,</span><br><span class="line"></span><br><span class="line">		<span class="number">-0.5f</span>,  <span class="number">0.5f</span>,  <span class="number">0.5f</span>,  <span class="number">1.0f</span>, <span class="number">0.0f</span>,</span><br><span class="line">		<span class="number">-0.5f</span>,  <span class="number">0.5f</span>, <span class="number">-0.5f</span>,  <span class="number">1.0f</span>, <span class="number">1.0f</span>,</span><br><span class="line">		<span class="number">-0.5f</span>, <span class="number">-0.5f</span>, <span class="number">-0.5f</span>,  <span class="number">0.0f</span>, <span class="number">1.0f</span>,</span><br><span class="line">		<span class="number">-0.5f</span>, <span class="number">-0.5f</span>, <span class="number">-0.5f</span>,  <span class="number">0.0f</span>, <span class="number">1.0f</span>,</span><br><span class="line">		<span class="number">-0.5f</span>, <span class="number">-0.5f</span>,  <span class="number">0.5f</span>,  <span class="number">0.0f</span>, <span class="number">0.0f</span>,</span><br><span class="line">		<span class="number">-0.5f</span>,  <span class="number">0.5f</span>,  <span class="number">0.5f</span>,  <span class="number">1.0f</span>, <span class="number">0.0f</span>,</span><br><span class="line"></span><br><span class="line">		 <span class="number">0.5f</span>,  <span class="number">0.5f</span>,  <span class="number">0.5f</span>,  <span class="number">1.0f</span>, <span class="number">0.0f</span>,</span><br><span class="line">		 <span class="number">0.5f</span>,  <span class="number">0.5f</span>, <span class="number">-0.5f</span>,  <span class="number">1.0f</span>, <span class="number">1.0f</span>,</span><br><span class="line">		 <span class="number">0.5f</span>, <span class="number">-0.5f</span>, <span class="number">-0.5f</span>,  <span class="number">0.0f</span>, <span class="number">1.0f</span>,</span><br><span class="line">		 <span class="number">0.5f</span>, <span class="number">-0.5f</span>, <span class="number">-0.5f</span>,  <span class="number">0.0f</span>, <span class="number">1.0f</span>,</span><br><span class="line">		 <span class="number">0.5f</span>, <span class="number">-0.5f</span>,  <span class="number">0.5f</span>,  <span class="number">0.0f</span>, <span class="number">0.0f</span>,</span><br><span class="line">		 <span class="number">0.5f</span>,  <span class="number">0.5f</span>,  <span class="number">0.5f</span>,  <span class="number">1.0f</span>, <span class="number">0.0f</span>,</span><br><span class="line"></span><br><span class="line">		<span class="number">-0.5f</span>, <span class="number">-0.5f</span>, <span class="number">-0.5f</span>,  <span class="number">0.0f</span>, <span class="number">1.0f</span>,</span><br><span class="line">		 <span class="number">0.5f</span>, <span class="number">-0.5f</span>, <span class="number">-0.5f</span>,  <span class="number">1.0f</span>, <span class="number">1.0f</span>,</span><br><span class="line">		 <span class="number">0.5f</span>, <span class="number">-0.5f</span>,  <span class="number">0.5f</span>,  <span class="number">1.0f</span>, <span class="number">0.0f</span>,</span><br><span class="line">		 <span class="number">0.5f</span>, <span class="number">-0.5f</span>,  <span class="number">0.5f</span>,  <span class="number">1.0f</span>, <span class="number">0.0f</span>,</span><br><span class="line">		<span class="number">-0.5f</span>, <span class="number">-0.5f</span>,  <span class="number">0.5f</span>,  <span class="number">0.0f</span>, <span class="number">0.0f</span>,</span><br><span class="line">		<span class="number">-0.5f</span>, <span class="number">-0.5f</span>, <span class="number">-0.5f</span>,  <span class="number">0.0f</span>, <span class="number">1.0f</span>,</span><br><span class="line"></span><br><span class="line">		<span class="number">-0.5f</span>,  <span class="number">0.5f</span>, <span class="number">-0.5f</span>,  <span class="number">0.0f</span>, <span class="number">1.0f</span>,</span><br><span class="line">		 <span class="number">0.5f</span>,  <span class="number">0.5f</span>, <span class="number">-0.5f</span>,  <span class="number">1.0f</span>, <span class="number">1.0f</span>,</span><br><span class="line">		 <span class="number">0.5f</span>,  <span class="number">0.5f</span>,  <span class="number">0.5f</span>,  <span class="number">1.0f</span>, <span class="number">0.0f</span>,</span><br><span class="line">		 <span class="number">0.5f</span>,  <span class="number">0.5f</span>,  <span class="number">0.5f</span>,  <span class="number">1.0f</span>, <span class="number">0.0f</span>,</span><br><span class="line">		<span class="number">-0.5f</span>,  <span class="number">0.5f</span>,  <span class="number">0.5f</span>,  <span class="number">0.0f</span>, <span class="number">0.0f</span>,</span><br><span class="line">		<span class="number">-0.5f</span>,  <span class="number">0.5f</span>, <span class="number">-0.5f</span>,  <span class="number">0.0f</span>, <span class="number">1.0f</span></span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//unsigned int indices[] =</span></span><br><span class="line">	<span class="comment">//&#123;</span></span><br><span class="line">	<span class="comment">//	0, 1, 3,</span></span><br><span class="line">	<span class="comment">//	1, 2, 3</span></span><br><span class="line">	<span class="comment">//&#125;;</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">glGenVertexArrays</span>(<span class="number">1</span>, &amp;VAO); <span class="comment">// 获取VAO VAO是管理容器</span></span><br><span class="line">	<span class="built_in">glBindVertexArray</span>(VAO); <span class="comment">// 绑定VAO</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//unsigned int EBO = 0;</span></span><br><span class="line">	<span class="comment">//glGenBuffers(1, &amp;EBO); // 向系统获取一个EBO</span></span><br><span class="line">	<span class="comment">//glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, EBO);</span></span><br><span class="line">	<span class="comment">//glBufferData(GL_ELEMENT_ARRAY_BUFFER, sizeof(indices), indices, GL_STATIC_DRAW);</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// 1. 获取VBO index</span></span><br><span class="line">	<span class="built_in">glGenBuffers</span>(<span class="number">1</span>, &amp;VBO); <span class="comment">// 获取VBO的index 可以获取多个VBO index</span></span><br><span class="line">	<span class="built_in">glBindBuffer</span>(GL_ARRAY_BUFFER, VBO); <span class="comment">// 绑定哪种buffer的哪一个</span></span><br><span class="line">	<span class="built_in">glBufferData</span>(GL_ARRAY_BUFFER, <span class="built_in">sizeof</span>(vertices), vertices, GL_STATIC_DRAW); <span class="comment">// 显存分配,类型、大小、位置、如何使用数据（GL_STATIC_DRAW 模型数据不会改变)</span></span><br><span class="line">	<span class="built_in">glVertexAttribPointer</span>(<span class="number">0</span>, <span class="number">3</span>, GL_FLOAT, GL_FALSE, <span class="number">5</span> * <span class="built_in">sizeof</span>(<span class="type">float</span>), (<span class="type">void</span>*)<span class="number">0</span>); <span class="comment">// 做锚定点 layout 锚定点0，3个数据，数据类型，是否归一化，跨步步长，数据读取开始位置</span></span><br><span class="line">	<span class="comment">// glVertexAttribPointer(1, 3, GL_FLOAT, GL_FALSE, 8 * sizeof(float), (void*)(sizeof(float) * 3)); // 锚定点1 传递颜色信息</span></span><br><span class="line">	<span class="built_in">glVertexAttribPointer</span>(<span class="number">1</span>, <span class="number">2</span>, GL_FLOAT, GL_FALSE, <span class="number">5</span> * <span class="built_in">sizeof</span>(<span class="type">float</span>), (<span class="type">void</span>*)(<span class="built_in">sizeof</span>(<span class="type">float</span>) * <span class="number">3</span>));</span><br><span class="line"></span><br><span class="line">	<span class="built_in">glEnableVertexAttribArray</span>(<span class="number">0</span>); <span class="comment">// 激活锚定点0</span></span><br><span class="line">	<span class="built_in">glEnableVertexAttribArray</span>(<span class="number">1</span>); <span class="comment">// 激活锚定点1</span></span><br><span class="line">	<span class="comment">// glEnableVertexAttribArray(2); </span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">glBindBuffer</span>(GL_ARRAY_BUFFER, <span class="number">0</span>); <span class="comment">// 取消绑定</span></span><br><span class="line">	<span class="built_in">glBindVertexArray</span>(<span class="number">0</span>); <span class="comment">// 结束VAO绑定</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">initTexture</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">// 创建纹理</span></span><br><span class="line">	_pImage = ffImage::<span class="built_in">readFromFile</span>(<span class="string">&quot;res/example.jpg&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">glGenTextures</span>(<span class="number">1</span>, &amp;_texture); <span class="comment">// 获取texture</span></span><br><span class="line">	<span class="built_in">glBindTexture</span>(GL_TEXTURE_2D, _texture);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">glTexParameteri</span>(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_REPEAT); <span class="comment">// Texture Wrapping</span></span><br><span class="line">	<span class="built_in">glTexParameteri</span>(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_REPEAT);</span><br><span class="line">	<span class="built_in">glTexParameteri</span>(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST); <span class="comment">// Texture Filter</span></span><br><span class="line">	<span class="built_in">glTexParameteri</span>(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_NEAREST);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">glTexImage2D</span>(GL_TEXTURE_2D, <span class="number">0</span>, GL_RGBA, _pImage-&gt;<span class="built_in">getWidth</span>(), _pImage-&gt;<span class="built_in">getHeight</span>(), <span class="number">0</span>, GL_RGBA, GL_UNSIGNED_BYTE, _pImage-&gt;<span class="built_in">getData</span>()); <span class="comment">// 传入数据</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Shader编写</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">initShader</span><span class="params">(<span class="type">const</span> <span class="type">char</span>* _vertexPath, <span class="type">const</span> <span class="type">char</span>* _fragPath)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	_shader.<span class="built_in">initShader</span>(_vertexPath, _fragPath);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">framebuffer_size_callback</span><span class="params">(GLFWwindow* window, <span class="type">int</span> width, <span class="type">int</span> height)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">glViewport</span>(<span class="number">0</span>, <span class="number">0</span>, _width, _height);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 当有任何输入时 比如键盘或鼠标事件</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">processInput</span><span class="params">(GLFWwindow* window)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (<span class="built_in">glfwGetKey</span>(window, GLFW_KEY_ESCAPE) == GLFW_PRESS)</span><br><span class="line">		<span class="built_in">glfwSetWindowShouldClose</span>(window, <span class="literal">true</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> (<span class="built_in">glfwGetKey</span>(window, GLFW_KEY_W) == GLFW_PRESS)</span><br><span class="line">	&#123;</span><br><span class="line">		_camera.<span class="built_in">move</span>(CAMERA_MOVE::MOVE_FRONT);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (<span class="built_in">glfwGetKey</span>(window, GLFW_KEY_S) == GLFW_PRESS)</span><br><span class="line">	&#123;</span><br><span class="line">		_camera.<span class="built_in">move</span>(CAMERA_MOVE::MOVE_BACK);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (<span class="built_in">glfwGetKey</span>(window, GLFW_KEY_A) == GLFW_PRESS)</span><br><span class="line">	&#123;</span><br><span class="line">		_camera.<span class="built_in">move</span>(CAMERA_MOVE::MOVE_LEFT);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (<span class="built_in">glfwGetKey</span>(window, GLFW_KEY_D) == GLFW_PRESS)</span><br><span class="line">	&#123;</span><br><span class="line">		_camera.<span class="built_in">move</span>(CAMERA_MOVE::MOVE_RIGHT);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">mouse_callback</span><span class="params">(GLFWwindow* window, <span class="type">double</span> xpos, <span class="type">double</span> ypos)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	_camera.<span class="built_in">onMouseMove</span>(xpos, ypos);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">glfwInit</span>(); <span class="comment">// opengl 状态初始化</span></span><br><span class="line">	<span class="comment">// 版本选择</span></span><br><span class="line">	<span class="built_in">glfwWindowHint</span>(GLFW_CONTEXT_VERSION_MAJOR, <span class="number">3</span>);</span><br><span class="line">	<span class="built_in">glfwWindowHint</span>(GLFW_CONTEXT_VERSION_MINOR, <span class="number">3</span>);</span><br><span class="line">	<span class="built_in">glfwWindowHint</span>(GLFW_OPENGL_PROFILE, GLFW_OPENGL_COMPAT_PROFILE); <span class="comment">//（配置项，配置结果）</span></span><br><span class="line">	<span class="comment">// glfwWindowHint(GLFW_OPENGL_PROFILE, GLFW_OPENGL_CORE_PROFILE); //（配置项，配置结果）</span></span><br><span class="line"></span><br><span class="line">	GLFWwindow* window = <span class="built_in">glfwCreateWindow</span>(<span class="number">800</span>, <span class="number">600</span>, <span class="string">&quot;OpenGL Core&quot;</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>);  <span class="comment">// 窗口定义	// 窗口宽高 名字</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (window == <span class="literal">NULL</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		std::cout &lt;&lt; <span class="string">&quot;Failed to create GLFW window&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">		<span class="built_in">glfwTerminate</span>();</span><br><span class="line">		<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">glfwMakeContextCurrent</span>(window); <span class="comment">// 当前上下文窗口绑定为当前窗口</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (!<span class="built_in">gladLoadGLLoader</span>((GLADloadproc)glfwGetProcAddress)) <span class="comment">// 初始化函数指针</span></span><br><span class="line">	&#123;</span><br><span class="line">		std::cout &lt;&lt; <span class="string">&quot;Fialed to initialize GLAD&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">glViewport</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">800</span>, <span class="number">600</span>);</span><br><span class="line">	<span class="built_in">glfwSetFramebufferSizeCallback</span>(window, framebuffer_size_callback); <span class="comment">// 窗口大小变化会调用函数</span></span><br><span class="line"></span><br><span class="line">	_camera.<span class="built_in">lookAt</span>(glm::<span class="built_in">vec3</span>(<span class="number">0.0f</span>, <span class="number">0.0f</span>, <span class="number">3.0f</span>), glm::<span class="built_in">vec3</span>(<span class="number">0.0f</span>, <span class="number">0.0f</span>, <span class="number">-1.0f</span>), glm::<span class="built_in">vec3</span>(<span class="number">0.0f</span>, <span class="number">1.0f</span>, <span class="number">0.0f</span>));</span><br><span class="line">	_camera.<span class="built_in">setSpeed</span>(<span class="number">0.01f</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 鼠标控制</span></span><br><span class="line">	<span class="built_in">glfwSetInputMode</span>(window, GLFW_CURSOR, GLFW_CURSOR_DISABLED); <span class="comment">// 鼠标不显示</span></span><br><span class="line">	<span class="built_in">glfwSetCursorPosCallback</span>(window, mouse_callback);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">initModel</span>();</span><br><span class="line">	<span class="built_in">initTexture</span>();</span><br><span class="line">	<span class="built_in">initShader</span>(<span class="string">&quot;vertexShader.glsl&quot;</span>, <span class="string">&quot;fragmentShader.glsl&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span> (!<span class="built_in">glfwWindowShouldClose</span>(window))</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">processInput</span>(window);</span><br><span class="line">		<span class="comment">// render</span></span><br><span class="line">		<span class="built_in">rend</span>();</span><br><span class="line"></span><br><span class="line">		<span class="built_in">glfwSwapBuffers</span>(window); <span class="comment">// 双缓存</span></span><br><span class="line">		<span class="built_in">glfwPollEvents</span>(); <span class="comment">// 操作系统获取输入和其他事件并处理 用于processInput</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">glfwTerminate</span>();</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="光照"><a href="#光照" class="headerlink" title="光照"></a>光照</h2><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://tryhardzhangblog.oss-us-west-1.aliyuncs.com/blog_image/image-20240731114207200.png" alt="image-20240731114207200" style="zoom:50%;" />

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://tryhardzhangblog.oss-us-west-1.aliyuncs.com/blog_image/image-20240731120813607.png" alt="image-20240731120813607"></p>
<h3 id="Phong-Shader-模型"><a href="#Phong-Shader-模型" class="headerlink" title="Phong Shader 模型"></a>Phong Shader 模型</h3><h3 id="环境光-Shader"><a href="#环境光-Shader" class="headerlink" title="环境光 Shader"></a>环境光 Shader</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Fragment Shader</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">float</span> ambientStrength = <span class="number">0.1</span>; <span class="comment">// 环境光强度系数</span></span><br><span class="line">	vec3 ambient = ambientStrength * lightColor;</span><br><span class="line">	</span><br><span class="line">	vec3 result = ambient * objectColor;</span><br><span class="line">	FragColor = <span class="built_in">vec4</span>(result, <span class="number">1.0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="漫反射-Shader"><a href="#漫反射-Shader" class="headerlink" title="漫反射 Shader"></a>漫反射 Shader</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://tryhardzhangblog.oss-us-west-1.aliyuncs.com/blog_image/image-20240731143355028.png" alt="image-20240731143355028"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://tryhardzhangblog.oss-us-west-1.aliyuncs.com/blog_image/image-20240731154359851.png" alt="image-20240731154359851"></p>
<p><strong>平移部分不会影响法线向量的计算 为0可以消除平移 的影响</strong></p>
<p><strong>gl_Position 将顶点的坐标转换到视图空间之中 FragPos是世界坐标</strong></p>
<h4 id="漫反射-法线矩阵证明"><a href="#漫反射-法线矩阵证明" class="headerlink" title="漫反射 法线矩阵证明"></a>漫反射 法线矩阵证明</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://tryhardzhangblog.oss-us-west-1.aliyuncs.com/blog_image/image-20240731153514547.png" alt="image-20240731153514547"></p>
<p><strong>在这里 dot可以转化为转置后的矩阵乘法</strong></p>
<h4 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_modelMatrix = glm::<span class="built_in">translate</span>(_modelMatrix, glm::<span class="built_in">vec3</span>(<span class="number">3.0f</span>, <span class="number">0.0f</span>, <span class="number">-3.0f</span>)); <span class="comment">// 与上次的结果产生了叠加</span></span><br></pre></td></tr></table></figure>

<p>可以使用 _modelMatrix  &#x3D; glm::mat4(1.0f) 清空</p>
<h4 id="transpose-inverse-modelMatrix"><a href="#transpose-inverse-modelMatrix" class="headerlink" title="transpose(inverse(_modelMatrix))"></a><strong><code>transpose(inverse(_modelMatrix))</code></strong></h4><p>对于法线向量的正确变换，仅仅使用模型矩阵的逆矩阵是不够的。需要使用逆矩阵的转置矩阵来确保法线的正确性。</p>
<ul>
<li><strong>为什么使用逆矩阵？</strong> 对于位置向量，我们使用模型矩阵来变换它们。然而，对于法线向量，特别是在非均匀缩放的情况下，如果直接使用模型矩阵来变换，法线方向可能会失真。因此，使用逆矩阵来反向缩放，确保法线向量的方向不受不均匀缩放的影响。</li>
<li><strong>为什么转置？</strong> 转置操作将行向量转换为列向量（或反之），这是确保法线方向保持正确的必要步骤，因为它对法线向量施加了正确的几何变换。</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#version 330 core</span></span><br><span class="line">out vec4 FragColor; <span class="comment">// 定义为out的变量会被输出到下一个步骤自动处理</span></span><br><span class="line"></span><br><span class="line">in vec2 outUV;</span><br><span class="line">in vec3 outFragPos; <span class="comment">// 经过偏移之后的世界坐标</span></span><br><span class="line">in vec3 outNormal;</span><br><span class="line"></span><br><span class="line"><span class="comment">// uniform vec4 ourColor;</span></span><br><span class="line">uniform sampler2D ourTexture;</span><br><span class="line">uniform vec3 light_color;</span><br><span class="line">uniform vec3 light_pos;</span><br><span class="line">uniform <span class="type">float</span> ambient_strength; <span class="comment">// 环境光强度</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">// 环境光</span></span><br><span class="line">	vec3 _ambient = light_color * ambient_strength;</span><br><span class="line">	<span class="comment">// 漫反射</span></span><br><span class="line">	vec3 _normal = <span class="built_in">normalize</span>(outNormal);</span><br><span class="line">	vec3 _lightDir = <span class="built_in">normalize</span>(light_pos - outFragPos);</span><br><span class="line">	<span class="type">float</span> _diff = <span class="built_in">max</span>(<span class="built_in">dot</span>(_normal, _lightDir), <span class="number">0.0f</span>);</span><br><span class="line">	vec3 _diffuse = light_color * _diff;</span><br><span class="line"></span><br><span class="line">	vec3 result = _ambient + _diffuse;</span><br><span class="line">	FragColor = <span class="built_in">texture</span>(ourTexture, outUV) * <span class="built_in">vec4</span>(result, <span class="number">1.0f</span>);</span><br><span class="line">	<span class="comment">// FragColor = texture(ourTexture, outUV)* ambient;</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="镜面反射"><a href="#镜面反射" class="headerlink" title="镜面反射"></a>镜面反射</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://tryhardzhangblog.oss-us-west-1.aliyuncs.com/blog_image/image-20240731172722456.png" alt="image-20240731172722456"></p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://tryhardzhangblog.oss-us-west-1.aliyuncs.com/blog_image/image-20240731173808343.png" alt="image-20240731173808343" style="zoom:67%;" />

<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://tryhardzhangblog.oss-us-west-1.aliyuncs.com/blog_image/image-20240731190203265.png" alt="image-20240731190203265" style="zoom: 50%;" />

<h2 id="材质系统"><a href="#材质系统" class="headerlink" title="材质系统"></a>材质系统</h2><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://tryhardzhangblog.oss-us-west-1.aliyuncs.com/blog_image/image-20240731191227383.png" alt="image-20240731191227383"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://tryhardzhangblog.oss-us-west-1.aliyuncs.com/blog_image/image-20240731192208031.png" alt="image-20240731192208031"></p>
<p><strong>材质和光都有自己的属性</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://tryhardzhangblog.oss-us-west-1.aliyuncs.com/blog_image/image-20240731192532460.png" alt="image-20240731192532460"></p>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://tryhardzhangblog.oss-us-west-1.aliyuncs.com/blog_imageavater.jpg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://tryhardzhangblog.oss-us-west-1.aliyuncs.com/blog_imageavater.jpg" title="头像" alt="头像"></a><div class="post-copyright__author_name">Edmend Zhang</div><div class="post-copyright__author_desc"></div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="http://example.com/2024/07/30/graphics/opengl/Opengl/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('http://example.com/2024/07/30/graphics/opengl/Opengl/')">OpenGL</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="http://example.com/2024/07/30/graphics/opengl/Opengl/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=OpenGL&amp;url=http://example.com/2024/07/30/graphics/opengl/Opengl/&amp;pic=https://tryhardzhangblog.oss-us-west-1.aliyuncs.com/cover_top_image/Photo%20by%20Adam%20Jaime%20%28iciBcD8NOeA%29.jpg?_r_=1dc7bada-bd3d-f366-f044-1e3cac7bc9c9" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/Graphics/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>Graphics<span class="tagsPageCount">13</span></a></div></div></div><div class="post_share"><div class="social-share" data-image="https://tryhardzhangblog.oss-us-west-1.aliyuncs.com/cover_top_image/Photo%20by%20Adam%20Jang%20%28Vj7XJtIm0Qk%29.jpg?_r_=f50f9fc3-55cd-aaa7-c892-8c1fe40780ed" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/07/29/graphics/Games101/Games%20101%20Homework/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://tryhardzhangblog.oss-us-west-1.aliyuncs.com/cover_top_image/Photo%20by%20Aachal%20%280S11oxS9vyc%29.jpg?_r_=84d08ea7-507c-9d60-1527-f8720f5bcb55" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">Homework</div></div></a></div><div class="next-post pull-right"><a href="/2024/07/30/graphics/Games101/Games%20101%20Geometry/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://tryhardzhangblog.oss-us-west-1.aliyuncs.com/cover_top_image/Photo%20by%20Aldebaran%20S%20%28nRAOQdF4IM4%29.jpg?_r_=4bf9ce86-d6b5-8519-8ade-cc07e7a428e0" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">Geometry</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/2024/07/30/graphics/Games101/Games%20101%20Geometry/" title="Geometry"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://tryhardzhangblog.oss-us-west-1.aliyuncs.com/cover_top_image/Photo%20by%20Aldebaran%20S%20%28nRAOQdF4IM4%29.jpg?_r_=4bf9ce86-d6b5-8519-8ade-cc07e7a428e0" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-07-30</div><div class="title">Geometry</div></div></a></div><div><a href="/2024/07/29/graphics/Games101/Games%20101%20Homework/" title="Homework"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://tryhardzhangblog.oss-us-west-1.aliyuncs.com/cover_top_image/Photo%20by%20Aachal%20%280S11oxS9vyc%29.jpg?_r_=84d08ea7-507c-9d60-1527-f8720f5bcb55" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-07-29</div><div class="title">Homework</div></div></a></div><div><a href="/2024/07/28/graphics/Games101/Games%20101%20Illumination%EF%BC%8CShading%20and%20Graphics%20Pipeline/" title="Illumination，Shading and Graphics Pipeline"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://tryhardzhangblog.oss-us-west-1.aliyuncs.com/cover_top_image/Photo%20by%20Alberto%20Restifo%20%28Ni4NgA64TFQ%29.jpg?_r_=f7ec4059-8637-8769-53fb-fb3457607566" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-07-28</div><div class="title">Illumination，Shading and Graphics Pipeline</div></div></a></div><div><a href="/2024/07/27/graphics/Games101/Games%20101%20Materials%20and%20Appearances/" title="Materials and Appearances"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://tryhardzhangblog.oss-us-west-1.aliyuncs.com/cover_top_image/Photo%20by%20Adam%20Przeniewski%20%28DgXiyrNE8FU%29.jpg?_r_=c9b8db03-526a-aa16-01e4-1dd549a054a9" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-07-27</div><div class="title">Materials and Appearances</div></div></a></div><div><a href="/2024/07/26/graphics/Games101/Games%20101%20Rasterization/" title="Rasterization"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://tryhardzhangblog.oss-us-west-1.aliyuncs.com/cover_top_image/Photo%20by%20Ales%20Krivec%20%2803YJ4PT6uKM%29.jpg?_r_=26bb56d9-db17-c155-cd83-8a18b15397f4" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-07-26</div><div class="title">Rasterization</div></div></a></div><div><a href="/2024/07/25/graphics/Games101/Games%20101%20Ray%20Tracing%EF%BC%881%EF%BC%89/" title="Ray Tracing（1）"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://tryhardzhangblog.oss-us-west-1.aliyuncs.com/cover_top_image/Photo%20by%20Abyan%20Athif%20%28DvYwy0mQdE0%29.jpg?_r_=aebf73e9-c4c5-23d5-c198-c7a9f9a26fa4" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-07-25</div><div class="title">Ray Tracing（1）</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="anzhiyufont anzhiyu-icon-comments"></i><span> Comment</span></div><div class="comment-randomInfo"><a onclick="anzhiyu.addRandomCommentInfo()" href="javascript:void(0)">匿名评论</a><a href="/privacy" style="margin-left: 4px">隐私政策</a></div><div class="comment-tips" id="comment-tips"><span>✅ 你无需删除空行，直接评论以获取最佳展示效果</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div><div class="comment-barrage"></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://tryhardzhangblog.oss-us-west-1.aliyuncs.com/blog_imageavater.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-status"><img class="g-status" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/08/24/64e6ce9c507bb.png" alt="status"/></div></div><div class="author-info__description"></div></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bullhorn anzhiyu-shake"></i><span>Announcement</span></div><div class="announcement_content">欢迎~</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#OpenGL-%EF%BC%881%EF%BC%89"><span class="toc-number">1.</span> <span class="toc-text">OpenGL （1）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#GLFW"><span class="toc-number">1.1.</span> <span class="toc-text">GLFW</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Glad"><span class="toc-number">1.2.</span> <span class="toc-text">Glad</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%8C%E7%BC%93%E5%AD%98"><span class="toc-number">1.2.1.</span> <span class="toc-text">双缓存</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Shader-%E5%A6%82%E4%BD%95%E4%BB%8ECPU%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE"><span class="toc-number">1.3.</span> <span class="toc-text">Shader 如何从CPU获取数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Shader"><span class="toc-number">1.4.</span> <span class="toc-text">Shader</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Vertex-Buffer-Object-VBO"><span class="toc-number">1.4.1.</span> <span class="toc-text">Vertex Buffer Object (VBO)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Vertex-Array-Object-VAO"><span class="toc-number">1.4.2.</span> <span class="toc-text">Vertex Array Object (VAO)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A8%8B%E5%BA%8F%E4%B8%AD%E5%85%B3%E7%B3%BB"><span class="toc-number">1.4.3.</span> <span class="toc-text">程序中关系</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%81%E7%A8%8B"><span class="toc-number">1.4.4.</span> <span class="toc-text">流程</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#VAO-%E6%A8%A1%E5%BC%8F%E7%BB%98%E5%88%B6"><span class="toc-number">1.5.</span> <span class="toc-text">VAO 模式绘制</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#OPENGL-%E9%83%A8%E5%88%86%E9%85%8D%E7%BD%AE%E9%97%AE%E9%A2%98"><span class="toc-number">1.6.</span> <span class="toc-text">OPENGL 部分配置问题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E4%B8%AAVBO%E7%9A%84%E6%83%85%E5%86%B5"><span class="toc-number">1.6.1.</span> <span class="toc-text">多个VBO的情况</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Shader%E4%B8%8EC-%E4%BC%A0%E8%BE%93"><span class="toc-number">1.6.2.</span> <span class="toc-text">Shader与C++传输</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%B6%E7%82%B9%E7%B4%A2%E5%BC%95"><span class="toc-number">1.6.3.</span> <span class="toc-text">顶点索引</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EBO-Element-Buffer-Object"><span class="toc-number">1.6.4.</span> <span class="toc-text">EBO Element Buffer Object</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Texture"><span class="toc-number">1.7.</span> <span class="toc-text">Texture</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A5%E9%AA%A4"><span class="toc-number">1.7.1.</span> <span class="toc-text">步骤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#STB-IMAGE-%E8%AF%BB%E5%8F%96%E5%9B%BE%E7%89%87"><span class="toc-number">1.7.2.</span> <span class="toc-text">STB_IMAGE 读取图片</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Texture-Wrapping"><span class="toc-number">1.7.3.</span> <span class="toc-text">Texture Wrapping</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Texture-Filter"><span class="toc-number">1.7.4.</span> <span class="toc-text">Texture Filter</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%91%84%E5%83%8F%E6%9C%BA"><span class="toc-number">1.8.</span> <span class="toc-text">摄像机</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%91%84%E5%83%8F%E6%9C%BA%E7%9F%A9%E9%98%B5"><span class="toc-number">1.8.1.</span> <span class="toc-text">摄像机矩阵</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9D%E5%A7%8B%E5%91%88%E5%83%8F"><span class="toc-number">1.8.1.1.</span> <span class="toc-text">初始呈像</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Lookat%E8%A7%92%E5%BA%A6-%E5%B9%B6%E6%B2%A1%E6%9C%89%E5%BC%80%E5%90%AF%E6%B7%B1%E5%BA%A6%E6%A3%80%E6%B5%8B"><span class="toc-number">1.8.1.2.</span> <span class="toc-text">Lookat角度 并没有开启深度检测</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%A0%E5%85%A5%E6%B7%B1%E5%BA%A6%E6%A3%80%E6%B5%8B%E5%90%8E"><span class="toc-number">1.8.1.3.</span> <span class="toc-text">加入深度检测后</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%91%84%E5%83%8F%E6%9C%BA%E7%9A%84%E7%A7%BB%E5%8A%A8%E6%97%8B%E8%BD%AC"><span class="toc-number">1.8.2.</span> <span class="toc-text">摄像机的移动旋转</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Rotate-move%E8%BF%90%E7%AE%97%E8%A7%84%E5%88%99"><span class="toc-number">1.8.2.1.</span> <span class="toc-text">Rotate move运算规则</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#LookAt%E4%BD%9C%E7%94%A8"><span class="toc-number">1.8.2.2.</span> <span class="toc-text">LookAt作用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#camera-cpp"><span class="toc-number">1.8.2.3.</span> <span class="toc-text">camera.cpp</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%91%84%E5%83%8F%E6%9C%BA%E8%BD%AC%E5%8A%A8"><span class="toc-number">1.8.3.</span> <span class="toc-text">摄像机转动</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#pitch-yaw-and-roll"><span class="toc-number">1.8.3.1.</span> <span class="toc-text">pitch yaw and roll</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%89%E7%85%A7"><span class="toc-number">1.9.</span> <span class="toc-text">光照</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Phong-Shader-%E6%A8%A1%E5%9E%8B"><span class="toc-number">1.9.1.</span> <span class="toc-text">Phong Shader 模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%8E%AF%E5%A2%83%E5%85%89-Shader"><span class="toc-number">1.9.2.</span> <span class="toc-text">环境光 Shader</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%AB%E5%8F%8D%E5%B0%84-Shader"><span class="toc-number">1.9.3.</span> <span class="toc-text">漫反射 Shader</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BC%AB%E5%8F%8D%E5%B0%84-%E6%B3%95%E7%BA%BF%E7%9F%A9%E9%98%B5%E8%AF%81%E6%98%8E"><span class="toc-number">1.9.3.1.</span> <span class="toc-text">漫反射 法线矩阵证明</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A1%A5%E5%85%85"><span class="toc-number">1.9.3.2.</span> <span class="toc-text">补充</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#transpose-inverse-modelMatrix"><span class="toc-number">1.9.3.3.</span> <span class="toc-text">transpose(inverse(_modelMatrix))</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%95%9C%E9%9D%A2%E5%8F%8D%E5%B0%84"><span class="toc-number">1.9.4.</span> <span class="toc-text">镜面反射</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9D%90%E8%B4%A8%E7%B3%BB%E7%BB%9F"><span class="toc-number">1.10.</span> <span class="toc-text">材质系统</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/07/31/intern/%E5%85%B3%E4%BA%8E%E8%99%9A%E6%8B%9F%E6%9C%BA%20virtualBox%20VMware%20%E5%92%8C%20wsl/" title="关于虚拟机 virtualBox VMware 和 wsl"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://tryhardzhangblog.oss-us-west-1.aliyuncs.com/cover_top_image/Photo%20by%20Adam%20Jang%20%28Vj7XJtIm0Qk%29.jpg?_r_=f50f9fc3-55cd-aaa7-c892-8c1fe40780ed" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="关于虚拟机 virtualBox VMware 和 wsl"/></a><div class="content"><a class="title" href="/2024/07/31/intern/%E5%85%B3%E4%BA%8E%E8%99%9A%E6%8B%9F%E6%9C%BA%20virtualBox%20VMware%20%E5%92%8C%20wsl/" title="关于虚拟机 virtualBox VMware 和 wsl">关于虚拟机 virtualBox VMware 和 wsl</a><time datetime="2024-07-31T11:26:16.554Z" title="Created 2024-07-31 11:26:16">2024-07-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/07/31/graphics/opengl/OpenGL%20Texture/" title="OpenGL"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://tryhardzhangblog.oss-us-west-1.aliyuncs.com/cover_top_image/Photo%20by%20Adam%20Jang%20%28Vj7XJtIm0Qk%29.jpg?_r_=2f6da939-7ca6-c37c-97a5-ebdcc6182fc7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="OpenGL"/></a><div class="content"><a class="title" href="/2024/07/31/graphics/opengl/OpenGL%20Texture/" title="OpenGL">OpenGL</a><time datetime="2024-07-31T11:26:16.554Z" title="Created 2024-07-31 11:26:16">2024-07-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/07/30/intern/FFMPE%E4%B8%8ESDL%E6%92%AD%E6%94%BE%E5%99%A8%E6%9E%B6%E6%9E%84/" title="FFMPEG+SDL播放器"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://tryhardzhangblog.oss-us-west-1.aliyuncs.com/cover_top_image/Photo%20by%20Alessio%20Soggetti%20%28IuSemNxGS88%29.jpg?_r_=3741bfcc-0bd0-7a40-f673-9492a8c409cc" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="FFMPEG+SDL播放器"/></a><div class="content"><a class="title" href="/2024/07/30/intern/FFMPE%E4%B8%8ESDL%E6%92%AD%E6%94%BE%E5%99%A8%E6%9E%B6%E6%9E%84/" title="FFMPEG+SDL播放器">FFMPEG+SDL播放器</a><time datetime="2024-07-30T00:00:00.000Z" title="Created 2024-07-30 00:00:00">2024-07-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/07/30/graphics/Games101/Games%20101%20Geometry/" title="Geometry"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://tryhardzhangblog.oss-us-west-1.aliyuncs.com/cover_top_image/Photo%20by%20Aldebaran%20S%20%28nRAOQdF4IM4%29.jpg?_r_=4bf9ce86-d6b5-8519-8ade-cc07e7a428e0" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Geometry"/></a><div class="content"><a class="title" href="/2024/07/30/graphics/Games101/Games%20101%20Geometry/" title="Geometry">Geometry</a><time datetime="2024-07-30T00:00:00.000Z" title="Created 2024-07-30 00:00:00">2024-07-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/07/30/graphics/opengl/Opengl/" title="OpenGL"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://tryhardzhangblog.oss-us-west-1.aliyuncs.com/cover_top_image/Photo%20by%20Adam%20Jaime%20%28iciBcD8NOeA%29.jpg?_r_=1dc7bada-bd3d-f366-f044-1e3cac7bc9c9" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="OpenGL"/></a><div class="content"><a class="title" href="/2024/07/30/graphics/opengl/Opengl/" title="OpenGL">OpenGL</a><time datetime="2024-07-30T00:00:00.000Z" title="Created 2024-07-30 00:00:00">2024-07-30</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div id="anzhiyu-footer"><div class="footer-group"><div class="footer-title">服务</div><div class="footer-links"><a class="footer-item" title="51la统计" target="_blank" rel="noopener" href="https://v6.51.la/">51la统计</a><a class="footer-item" title="十年之约" target="_blank" rel="noopener" href="https://www.foreverblog.cn/">十年之约</a><a class="footer-item" title="开往" target="_blank" rel="noopener" href="https://github.com/travellings-link/travellings">开往</a></div></div><div class="footer-group"><div class="footer-title">主题</div><div class="footer-links"><a class="footer-item" title="文档" href="/docs/">文档</a><a class="footer-item" title="源码" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu">源码</a><a class="footer-item" title="更新日志" href="/update/">更新日志</a></div></div><div class="footer-group"><div class="footer-title">导航</div><div class="footer-links"><a class="footer-item" title="即刻短文" href="/essay/">即刻短文</a><a class="footer-item" title="友链文章" href="/fcircle/">友链文章</a><a class="footer-item" title="留言板" href="/comments/">留言板</a></div></div><div class="footer-group"><div class="footer-title">协议</div><div class="footer-links"><a class="footer-item" title="隐私协议" href="/privacy/">隐私协议</a><a class="footer-item" title="Cookies" href="/cookies/">Cookies</a><a class="footer-item" title="版权协议" href="/copyright/">版权协议</a></div></div><div class="footer-group"><div class="footer-title-group"><div class="footer-title">友链</div><a class="random-friends-btn" id="footer-random-friends-btn" href="javascript:addFriendLinksInFooter();" title="换一批友情链接"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right"></i></a></div><div class="footer-links" id="friend-links-in-footer"></div></div></div></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2020 - 2024 By <a class="footer-bar-link" href="/" title="Edmend Zhang" target="_blank">Edmend Zhang</a></div></div><div id="footer-type-tips"></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">Articles</div><div class="length-num">32</div></a><a href="/tags/" title="tag"><div class="headline">Tags</div><div class="length-num">17</div></a><a href="/categories/" title="category"><div class="headline">Categories</div><div class="length-num">9</div></a></div><span class="sidebar-menu-item-title">Function</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="Display Mode"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>Display Mode</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://blog.tryhardzhang.xyz/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://blog.tryhardzhang.xyz/" title="none"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.anheyu.com/favicon.ico" alt="none"/><span class="back-menu-item-text">none</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 想法</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/?id=9570676565&amp;server=netease"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册集</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/air-conditioner/"><i class="anzhiyufont anzhiyu-icon-fan faa-tada" style="font-size: 0.9em;"></i><span> 小空调</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 闲言碎语</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随便逛逛</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/Docker/" style="font-size: 0.88rem;">Docker<sup>2</sup></a><a href="/tags/Graphics/" style="font-size: 0.88rem;">Graphics<sup>13</sup></a><a href="/tags/Graphics-Games101/" style="font-size: 0.88rem;">Graphics - Games101<sup>1</sup></a><a href="/tags/Home-Assistant-%E9%9B%86%E6%88%90-Frigate-%E5%8A%9F%E8%83%BD%E5%B1%95%E7%A4%BA/" style="font-size: 0.88rem;">Home Assistant 集成 Frigate 功能展示<sup>1</sup></a><a href="/tags/HomeAssistant/" style="font-size: 0.88rem;">HomeAssistant<sup>1</sup></a><a href="/tags/RTP/" style="font-size: 0.88rem;">RTP<sup>1</sup></a><a href="/tags/RTSP/" style="font-size: 0.88rem;">RTSP<sup>3</sup></a><a href="/tags/concepts/" style="font-size: 0.88rem;">concepts<sup>2</sup></a><a href="/tags/csen-272/" style="font-size: 0.88rem;">csen 272<sup>2</sup></a><a href="/tags/live555/" style="font-size: 0.88rem;">live555<sup>1</sup></a><a href="/tags/nlp/" style="font-size: 0.88rem;">nlp<sup>2</sup></a><a href="/tags/search/" style="font-size: 0.88rem;">search<sup>2</sup></a><a href="/tags/%E5%8D%9A%E5%AE%A2/" style="font-size: 0.88rem;">博客<sup>1</sup></a><a href="/tags/%E8%99%9A%E6%8B%9F%E6%9C%BA/" style="font-size: 0.88rem;">虚拟机<sup>1</sup></a><a href="/tags/%E8%A7%86%E9%A2%91%E6%92%AD%E6%94%BE%E5%99%A8/" style="font-size: 0.88rem;">视频播放器<sup>1</sup></a><a href="/tags/%E8%A7%86%E9%A2%91%E6%B5%81%E4%BC%A0%E8%BE%93/" style="font-size: 0.88rem;">视频流传输<sup>1</sup></a><a href="/tags/%E8%AF%BE%E7%A8%8B/" style="font-size: 0.88rem;">课程<sup>1</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="Switch Between Traditional Chinese And Simplified Chinese">繁</button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Setting"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><a id="to_comment" href="#post-comment" title="Scroll To Comments"><i class="anzhiyufont anzhiyu-icon-comments"></i></a><button id="go-up" type="button" title="Back To Top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="9570676565" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="algolia-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><button class="search-close-button"><i class="anzhiyufont anzhiyu-icon-xmark"></i></button></nav><div class="search-wrap"><div id="algolia-search-input"></div><hr/><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-info"><div class="algolia-stats"></div><div class="algolia-poweredBy"></div></div></div></div></div><div id="search-mask"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://music.163.com/#/playlist?id=9570676565&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("04/01/2021 00:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2020 By 安知鱼 V1.6.12",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 Edmend Zhang 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><script src="https://cdn.cbd.int/algoliasearch@4.18.0/dist/algoliasearch-lite.umd.js"></script><script src="https://cdn.cbd.int/instantsearch.js@4.60.0/dist/instantsearch.production.min.js"></script><script src="/js/search/algolia.js"></script><div class="js-pjax"><script>(() => {
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://tryhardzhang.netlify.app/.netlify/functions/twikoo',
      region: '',
      onCommentLoaded: () => {
        anzhiyu.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') setTimeout(runFn,0)
    else getScript('https://cdn.cbd.int/twikoo@1.6.25/dist/twikoo.all.min.js').then(runFn)
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://tryhardzhang.netlify.app/.netlify/functions/twikoo',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const runFn = () => {
    init();
    
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) anzhiyu.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else {
      loadTwikoo()
    }
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script><input type="hidden" name="page-type" id="page-type" value="post"></div><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[image]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[link]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[code]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const getComment = () => {
    const runTwikoo = () => {
      twikoo.getRecentComments({
        envId: 'https://tryhardzhang.netlify.app/.netlify/functions/twikoo',
        region: '',
        pageSize: 6,
        includeReply: true
      }).then(function (res) {
        const twikooArray = res.map(e => {
          return {
            'content': changeContent(e.comment),
            'avatar': e.avatar,
            'nick': e.nick,
            'url': e.url + '#' + e.id,
            'date': new Date(e.created).toISOString()
          }
        })

        saveToLocal.set('twikoo-newest-comments', JSON.stringify(twikooArray), 10/(60*24))
        generateHtml(twikooArray)
      }).catch(function (err) {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.textContent= "Unable to get the data, please make sure the settings are correct."
      })
    }

    if (typeof twikoo === 'object') {
      runTwikoo()
    } else {
      getScript('https://cdn.cbd.int/twikoo@1.6.25/dist/twikoo.all.min.js').then(runTwikoo)
    }
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'data-lazy-src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'><div class='name'><span>${array[i].nick} </span></div></a>`
        }
        
        result += `<div class='content'>
        <a class='comment' href='${array[i].url}' title='${array[i].content}'>${array[i].content}</a>
        <time datetime="${array[i].date}">${anzhiyu.diffDate(array[i].date, true)}</time></div>
        </div>`
      }
    } else {
      result += 'No Comment'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom && ($dom.innerHTML= result)
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('twikoo-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><script src="/js/anzhiyu/right_click_menu.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["meta[property=\"og:image\"]","meta[property=\"og:title\"]","meta[property=\"og:url\"]","meta[property=\"og:type\"]","meta[property=\"og:site_name\"]","meta[property=\"og:description\"]","head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>